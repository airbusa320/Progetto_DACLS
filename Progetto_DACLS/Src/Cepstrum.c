/****************************************************************
 *  															*
 *   Cepstrum.c												*
 * 																*
 *    Created on: 24 mar 2018									*
 *        Author: Riccardo, Stefano								*
 *	 															*
 ****************************************************************

 ================================================================
                  ##### Estrazione MFCC #####
 ================================================================

 Modificare la definizione FSTART, FSTOP, FS, NFFT, NFILT in
 accordo alle proprie esigenze.

 La funzione tFiltInit costruisce il banco filtri MEL e calcola
 i coefficienti per il calcolo della DCT.

 La funzione estrazione calcola i coefficienti MFCC relativi
 al frame passato in ingresso.
 */


#include "Cepstrum.h"

#include "math.h"
#include "arm_const_structs.h"
#include "tim.h"


const float32_t tappi[]={-0.97, 1};


const float32_t hamwin[]={	// finestra di hamming
		0.079999998,	// (1-alfa)-alfa*cos(2*PI*n/(N-1)), 0<=n<=N-1
		0.08003477,		// con alfa=0.46
		0.080139086,
		0.080312923,
		0.080556259,
		0.080869056,
		0.081251271,
		0.081702836,
		0.082223698,
		0.082813762,
		0.083472952,
		0.084201157,
		0.084998272,
		0.085864186,
		0.08679875,
		0.087801836,
		0.08887329,
		0.090012945,
		0.091220632,
		0.092496164,
		0.093839362,
		0.095250003,
		0.096727893,
		0.098272793,
		0.09988448,
		0.10156271,
		0.10330722,
		0.10511775,
		0.10699403,
		0.10893578,
		0.1109427,
		0.11301448,
		0.11515082,
		0.11735139,
		0.11961586,
		0.12194388,
		0.12433512,
		0.12678918,
		0.12930574,
		0.13188437,
		0.1345247,
		0.13722634,
		0.13998888,
		0.14281189,
		0.14569496,
		0.14863762,
		0.15163946,
		0.15470003,
		0.15781882,
		0.16099542,
		0.1642293,
		0.16752,
		0.17086703,
		0.17426984,
		0.17772795,
		0.18124084,
		0.18480797,
		0.1884288,
		0.19210277,
		0.19582935,
		0.19960797,
		0.20343803,
		0.20731899,
		0.21125025,
		0.2152312,
		0.21926126,
		0.2233398,
		0.22746623,
		0.23163989,
		0.23586018,
		0.24012646,
		0.24443807,
		0.24879436,
		0.25319469,
		0.25763837,
		0.26212475,
		0.26665312,
		0.27122283,
		0.27583319,
		0.28048345,
		0.285173,
		0.28990105,
		0.29466689,
		0.29946983,
		0.30430916,
		0.3091841,
		0.31409395,
		0.31903794,
		0.32401535,
		0.32902539,
		0.33406734,
		0.33914044,
		0.34424388,
		0.34937695,
		0.3545388,
		0.35972872,
		0.36494589,
		0.37018952,
		0.37545881,
		0.38075298,
		0.38607123,
		0.39141276,
		0.39677677,
		0.4021624,
		0.4075689,
		0.4129954,
		0.41844109,
		0.42390519,
		0.42938682,
		0.43488517,
		0.44039944,
		0.44592875,
		0.45147228,
		0.45702919,
		0.46259865,
		0.46817982,
		0.47377184,
		0.47937387,
		0.48498505,
		0.49060458,
		0.49623156,
		0.50186515,
		0.50750452,
		0.51314878,
		0.51879716,
		0.52444869,
		0.53010261,
		0.53575796,
		0.54141402,
		0.54706985,
		0.5527246,
		0.55837744,
		0.56402749,
		0.5696739,
		0.57531583,
		0.58095241,
		0.58658278,
		0.59220618,
		0.59782165,
		0.60342836,
		0.60902548,
		0.61461216,
		0.62018758,
		0.6257509,
		0.63130122,
		0.63683772,
		0.64235961,
		0.64786601,
		0.65335613,
		0.65882909,
		0.66428411,
		0.66972029,
		0.67513692,
		0.68053305,
		0.68590802,
		0.69126087,
		0.69659084,
		0.70189714,
		0.70717901,
		0.71243554,
		0.71766609,
		0.72286969,
		0.7280457,
		0.73319322,
		0.73831159,
		0.74339998,
		0.74845755,
		0.75348365,
		0.75847751,
		0.76343828,
		0.76836532,
		0.77325779,
		0.77811503,
		0.78293622,
		0.78772074,
		0.79246777,
		0.79717666,
		0.80184662,
		0.80647701,
		0.81106716,
		0.81561625,
		0.82012373,
		0.82458884,
		0.8290109,
		0.83338934,
		0.83772337,
		0.84201241,
		0.84625572,
		0.85045278,
		0.85460293,
		0.85870552,
		0.86275989,
		0.86676544,
		0.87072164,
		0.87462783,
		0.87848341,
		0.8822878,
		0.88604045,
		0.88974082,
		0.89338827,
		0.89698231,
		0.90052241,
		0.90400797,
		0.90743852,
		0.91081351,
		0.91413242,
		0.91739476,
		0.92060006,
		0.92374784,
		0.92683756,
		0.92986882,
		0.93284112,
		0.93575406,
		0.93860716,
		0.94139999,
		0.94413209,
		0.94680315,
		0.9494127,
		0.95196033,
		0.95444566,
		0.95686835,
		0.95922804,
		0.96152437,
		0.96375692,
		0.9659254,
		0.9680295,
		0.97006887,
		0.97204328,
		0.97395229,
		0.97579575,
		0.97757334,
		0.9792847,
		0.98092967,
		0.982508,
		0.98401946,
		0.98546374,
		0.98684067,
		0.98815006,
		0.98939168,
		0.99056542,
		0.99167097,
		0.99270827,
		0.99367708,
		0.99457735,
		0.99540889,
		0.99617159,
		0.99686527,
		0.99748993,
		0.99804538,
		0.99853164,
		0.99894851,
		0.99929601,
		0.99957407,
		0.99978268,
		0.99992174,
		0.9999913,
		0.9999913,
		0.99992174,
		0.99978268,
		0.99957407,
		0.99929601,
		0.99894851,
		0.99853164,
		0.99804538,
		0.99748993,
		0.99686527,
		0.99617159,
		0.99540889,
		0.99457735,
		0.99367708,
		0.99270827,
		0.99167097,
		0.99056542,
		0.98939168,
		0.98815006,
		0.98684067,
		0.98546374,
		0.98401946,
		0.982508,
		0.98092967,
		0.9792847,
		0.97757334,
		0.97579575,
		0.97395229,
		0.97204328,
		0.97006887,
		0.9680295,
		0.9659254,
		0.96375692,
		0.96152437,
		0.95922804,
		0.95686835,
		0.95444566,
		0.95196033,
		0.9494127,
		0.94680315,
		0.94413209,
		0.94139999,
		0.93860716,
		0.93575406,
		0.93284112,
		0.92986882,
		0.92683756,
		0.92374784,
		0.92060006,
		0.91739476,
		0.91413242,
		0.91081351,
		0.90743852,
		0.90400797,
		0.90052241,
		0.89698231,
		0.89338827,
		0.88974082,
		0.88604045,
		0.8822878,
		0.87848341,
		0.87462783,
		0.87072164,
		0.86676544,
		0.86275989,
		0.85870552,
		0.85460293,
		0.85045278,
		0.84625572,
		0.84201241,
		0.83772337,
		0.83338934,
		0.8290109,
		0.82458884,
		0.82012373,
		0.81561625,
		0.81106716,
		0.80647701,
		0.80184662,
		0.79717666,
		0.79246777,
		0.78772074,
		0.78293622,
		0.77811503,
		0.77325779,
		0.76836532,
		0.76343828,
		0.75847751,
		0.75348365,
		0.74845755,
		0.74339998,
		0.73831159,
		0.73319322,
		0.7280457,
		0.72286969,
		0.71766609,
		0.71243554,
		0.70717901,
		0.70189714,
		0.69659084,
		0.69126087,
		0.68590802,
		0.68053305,
		0.67513692,
		0.66972029,
		0.66428411,
		0.65882909,
		0.65335613,
		0.64786601,
		0.64235961,
		0.63683772,
		0.63130122,
		0.6257509,
		0.62018758,
		0.61461216,
		0.60902548,
		0.60342836,
		0.59782165,
		0.59220618,
		0.58658278,
		0.58095241,
		0.57531583,
		0.5696739,
		0.56402749,
		0.55837744,
		0.5527246,
		0.54706985,
		0.54141402,
		0.53575796,
		0.53010261,
		0.52444869,
		0.51879716,
		0.51314878,
		0.50750452,
		0.50186515,
		0.49623156,
		0.49060458,
		0.48498505,
		0.47937387,
		0.47377184,
		0.46817982,
		0.46259865,
		0.45702919,
		0.45147228,
		0.44592875,
		0.44039944,
		0.43488517,
		0.42938682,
		0.42390519,
		0.41844109,
		0.4129954,
		0.4075689,
		0.4021624,
		0.39677677,
		0.39141276,
		0.38607123,
		0.38075298,
		0.37545881,
		0.37018952,
		0.36494589,
		0.35972872,
		0.3545388,
		0.34937695,
		0.34424388,
		0.33914044,
		0.33406734,
		0.32902539,
		0.32401535,
		0.31903794,
		0.31409395,
		0.3091841,
		0.30430916,
		0.29946983,
		0.29466689,
		0.28990105,
		0.285173,
		0.28048345,
		0.27583319,
		0.27122283,
		0.26665312,
		0.26212475,
		0.25763837,
		0.25319469,
		0.24879436,
		0.24443807,
		0.24012646,
		0.23586018,
		0.23163989,
		0.22746623,
		0.2233398,
		0.21926126,
		0.2152312,
		0.21125025,
		0.20731899,
		0.20343803,
		0.19960797,
		0.19582935,
		0.19210277,
		0.1884288,
		0.18480797,
		0.18124084,
		0.17772795,
		0.17426984,
		0.17086703,
		0.16752,
		0.1642293,
		0.16099542,
		0.15781882,
		0.15470003,
		0.15163946,
		0.14863762,
		0.14569496,
		0.14281189,
		0.13998888,
		0.13722634,
		0.1345247,
		0.13188437,
		0.12930574,
		0.12678918,
		0.12433512,
		0.12194388,
		0.11961586,
		0.11735139,
		0.11515082,
		0.11301448,
		0.1109427,
		0.10893578,
		0.10699403,
		0.10511775,
		0.10330722,
		0.10156271,
		0.09988448,
		0.098272793,
		0.096727893,
		0.095250003,
		0.093839362,
		0.092496164,
		0.091220632,
		0.090012945,
		0.08887329,
		0.087801836,
		0.08679875,
		0.085864186,
		0.084998272,
		0.084201157,
		0.083472952,
		0.082813762,
		0.082223698,
		0.081702836,
		0.081251271,
		0.080869056,
		0.080556259,
		0.080312923,
		0.080139086,
		0.08003477,
		0.079999998,

};

const float32_t hamwin2048[]={
		0.079999998,
		0.080002166,
		0.080008671,
		0.080019504,
		0.080034673,
		0.080054171,
		0.080078006,
		0.080106176,
		0.080138676,
		0.080175512,
		0.080216676,
		0.080262177,
		0.080312006,
		0.080366172,
		0.080424659,
		0.080487482,
		0.080554634,
		0.080626108,
		0.080701917,
		0.080782056,
		0.080866516,
		0.080955304,
		0.081048414,
		0.081145845,
		0.081247605,
		0.081353687,
		0.081464089,
		0.081578813,
		0.081697851,
		0.081821218,
		0.081948891,
		0.082080886,
		0.082217187,
		0.082357809,
		0.082502738,
		0.08265198,
		0.082805529,
		0.082963385,
		0.083125554,
		0.083292022,
		0.08346279,
		0.083637863,
		0.083817236,
		0.084000908,
		0.084188871,
		0.084381133,
		0.084577687,
		0.084778532,
		0.084983662,
		0.085193083,
		0.085406788,
		0.085624777,
		0.085847043,
		0.086073592,
		0.086304419,
		0.086539514,
		0.086778887,
		0.087022528,
		0.087270439,
		0.087522611,
		0.087779053,
		0.088039748,
		0.088304706,
		0.088573918,
		0.088847384,
		0.089125097,
		0.089407064,
		0.089693271,
		0.089983724,
		0.090278409,
		0.090577342,
		0.090880506,
		0.091187902,
		0.091499522,
		0.091815367,
		0.092135444,
		0.092459731,
		0.092788242,
		0.093120962,
		0.093457893,
		0.093799025,
		0.094144367,
		0.094493911,
		0.094847649,
		0.09520559,
		0.095567711,
		0.095934026,
		0.096304521,
		0.096679196,
		0.09705805,
		0.097441077,
		0.097828269,
		0.098219633,
		0.098615155,
		0.099014841,
		0.099418677,
		0.099826664,
		0.1002388,
		0.10065508,
		0.10107549,
		0.10150005,
		0.10192873,
		0.10236154,
		0.10279848,
		0.10323954,
		0.1036847,
		0.10413399,
		0.10458737,
		0.10504486,
		0.10550644,
		0.10597213,
		0.10644189,
		0.10691575,
		0.10739368,
		0.1078757,
		0.10836177,
		0.10885192,
		0.10934614,
		0.1098444,
		0.11034673,
		0.11085309,
		0.11136351,
		0.11187796,
		0.11239644,
		0.11291895,
		0.11344549,
		0.11397605,
		0.11451062,
		0.11504919,
		0.11559177,
		0.11613835,
		0.11668893,
		0.11724349,
		0.11780204,
		0.11836456,
		0.11893106,
		0.11950152,
		0.12007594,
		0.12065432,
		0.12123665,
		0.12182293,
		0.12241315,
		0.1230073,
		0.12360538,
		0.12420738,
		0.1248133,
		0.12542313,
		0.12603687,
		0.12665451,
		0.12727605,
		0.12790146,
		0.12853077,
		0.12916395,
		0.12980101,
		0.13044192,
		0.13108669,
		0.13173531,
		0.13238779,
		0.13304411,
		0.13370426,
		0.13436823,
		0.13503602,
		0.13570765,
		0.13638306,
		0.13706228,
		0.13774531,
		0.13843212,
		0.13912271,
		0.13981709,
		0.14051522,
		0.14121713,
		0.1419228,
		0.14263222,
		0.14334537,
		0.14406227,
		0.14478289,
		0.14550723,
		0.1462353,
		0.14696707,
		0.14770254,
		0.14844173,
		0.14918458,
		0.14993113,
		0.15068135,
		0.15143524,
		0.15219279,
		0.152954,
		0.15371884,
		0.15448733,
		0.15525945,
		0.1560352,
		0.15681456,
		0.15759754,
		0.15838411,
		0.15917428,
		0.15996805,
		0.16076538,
		0.1615663,
		0.16237077,
		0.16317882,
		0.16399039,
		0.16480553,
		0.16562419,
		0.16644639,
		0.16727209,
		0.16810131,
		0.16893405,
		0.16977027,
		0.17060998,
		0.17145316,
		0.17229983,
		0.17314996,
		0.17400354,
		0.17486058,
		0.17572105,
		0.17658496,
		0.17745228,
		0.17832303,
		0.17919718,
		0.18007472,
		0.18095566,
		0.18183999,
		0.18272769,
		0.18361875,
		0.18451318,
		0.18541096,
		0.18631206,
		0.18721652,
		0.18812428,
		0.18903537,
		0.18994975,
		0.19086745,
		0.19178842,
		0.19271268,
		0.19364022,
		0.194571,
		0.19550505,
		0.19644235,
		0.19738288,
		0.19832665,
		0.19927362,
		0.20022382,
		0.20117719,
		0.20213379,
		0.20309354,
		0.20405649,
		0.20502259,
		0.20599185,
		0.20696425,
		0.2079398,
		0.20891848,
		0.20990027,
		0.21088518,
		0.21187317,
		0.21286428,
		0.21385846,
		0.2148557,
		0.21585602,
		0.21685939,
		0.21786579,
		0.21887524,
		0.21988772,
		0.2209032,
		0.2219217,
		0.22294319,
		0.22396767,
		0.22499514,
		0.22602555,
		0.22705893,
		0.22809526,
		0.22913453,
		0.23017673,
		0.23122185,
		0.23226988,
		0.2333208,
		0.23437463,
		0.23543131,
		0.23649088,
		0.2375533,
		0.23861858,
		0.2396867,
		0.24075763,
		0.24183139,
		0.24290797,
		0.24398734,
		0.24506949,
		0.24615443,
		0.24724214,
		0.2483326,
		0.24942581,
		0.25052178,
		0.25162044,
		0.25272185,
		0.25382593,
		0.25493273,
		0.25604221,
		0.25715438,
		0.25826919,
		0.25938669,
		0.26050681,
		0.26162955,
		0.26275492,
		0.26388291,
		0.26501352,
		0.26614669,
		0.26728246,
		0.26842079,
		0.26956168,
		0.2707051,
		0.27185109,
		0.27299958,
		0.27415061,
		0.27530414,
		0.27646014,
		0.27761865,
		0.2787796,
		0.27994305,
		0.28110892,
		0.28227726,
		0.28344798,
		0.28462115,
		0.28579673,
		0.2869747,
		0.28815505,
		0.28933778,
		0.29052287,
		0.29171029,
		0.29290006,
		0.29409218,
		0.2952866,
		0.29648331,
		0.29768234,
		0.29888365,
		0.30008721,
		0.30129305,
		0.30250114,
		0.30371147,
		0.30492401,
		0.30613878,
		0.30735573,
		0.30857489,
		0.30979624,
		0.31101975,
		0.3122454,
		0.31347322,
		0.31470317,
		0.31593522,
		0.3171694,
		0.31840569,
		0.31964403,
		0.3208845,
		0.32212698,
		0.32337156,
		0.32461816,
		0.32586679,
		0.32711744,
		0.32837009,
		0.32962474,
		0.33088136,
		0.33213997,
		0.33340052,
		0.334663,
		0.33592746,
		0.33719382,
		0.33846208,
		0.33973226,
		0.34100431,
		0.34227824,
		0.34355405,
		0.34483168,
		0.34611118,
		0.34739247,
		0.34867561,
		0.34996054,
		0.35124725,
		0.35253575,
		0.35382602,
		0.35511804,
		0.35641178,
		0.35770729,
		0.3590045,
		0.3603034,
		0.36160401,
		0.36290628,
		0.36421025,
		0.36551586,
		0.36682311,
		0.368132,
		0.36944249,
		0.3707546,
		0.37206832,
		0.37338361,
		0.37470046,
		0.37601888,
		0.37733883,
		0.37866032,
		0.37998334,
		0.38130787,
		0.38263386,
		0.38396138,
		0.38529035,
		0.38662076,
		0.38795266,
		0.38928595,
		0.39062068,
		0.39195681,
		0.39329433,
		0.39463323,
		0.3959735,
		0.39731514,
		0.39865813,
		0.40000245,
		0.40134808,
		0.402695,
		0.40404323,
		0.40539274,
		0.40674353,
		0.40809557,
		0.40944883,
		0.41080335,
		0.41215909,
		0.41351599,
		0.41487411,
		0.41623342,
		0.4175939,
		0.4189555,
		0.42031828,
		0.42168215,
		0.42304716,
		0.42441326,
		0.42578045,
		0.42714873,
		0.42851806,
		0.42988843,
		0.43125984,
		0.4326323,
		0.43400574,
		0.43538019,
		0.43675566,
		0.43813205,
		0.43950942,
		0.44088775,
		0.442267,
		0.44364718,
		0.44502825,
		0.44641024,
		0.4477931,
		0.44917682,
		0.4505614,
		0.45194682,
		0.45333308,
		0.45472014,
		0.45610803,
		0.4574967,
		0.45888615,
		0.46027634,
		0.4616673,
		0.46305901,
		0.46445143,
		0.46584454,
		0.4672384,
		0.46863291,
		0.4700281,
		0.47142392,
		0.47282043,
		0.47421756,
		0.47561529,
		0.47701365,
		0.4784126,
		0.47981215,
		0.48121223,
		0.48261288,
		0.48401406,
		0.48541579,
		0.48681802,
		0.48822075,
		0.48962396,
		0.49102765,
		0.49243182,
		0.49383643,
		0.49524146,
		0.49664691,
		0.49805278,
		0.49945906,
		0.5008657,
		0.50227273,
		0.50368011,
		0.50508779,
		0.50649583,
		0.50790417,
		0.50931287,
		0.5107218,
		0.51213104,
		0.51354051,
		0.51495028,
		0.51636022,
		0.51777041,
		0.51918083,
		0.52059144,
		0.52200222,
		0.52341318,
		0.52482426,
		0.52623552,
		0.5276469,
		0.5290584,
		0.53047001,
		0.53188169,
		0.53329349,
		0.53470528,
		0.5361172,
		0.53752911,
		0.53894103,
		0.540353,
		0.54176491,
		0.54317689,
		0.54458874,
		0.5460006,
		0.54741246,
		0.54882413,
		0.55023581,
		0.55164737,
		0.5530588,
		0.55447012,
		0.55588132,
		0.55729234,
		0.55870318,
		0.56011391,
		0.56152439,
		0.5629347,
		0.56434476,
		0.56575465,
		0.56716424,
		0.56857359,
		0.56998271,
		0.57139152,
		0.57280004,
		0.5742082,
		0.57561612,
		0.57702363,
		0.57843083,
		0.57983768,
		0.58124411,
		0.58265018,
		0.58405584,
		0.58546114,
		0.58686596,
		0.58827031,
		0.58967423,
		0.59107769,
		0.59248066,
		0.59388316,
		0.59528512,
		0.5966866,
		0.59808749,
		0.5994879,
		0.60088772,
		0.60228693,
		0.60368562,
		0.60508364,
		0.60648108,
		0.60787791,
		0.60927409,
		0.61066961,
		0.61206442,
		0.61345863,
		0.61485213,
		0.61624491,
		0.61763692,
		0.61902827,
		0.62041885,
		0.62180871,
		0.62319773,
		0.62458599,
		0.62597346,
		0.62736017,
		0.62874597,
		0.63013101,
		0.63151515,
		0.63289845,
		0.63428086,
		0.63566238,
		0.637043,
		0.63842273,
		0.6398015,
		0.64117938,
		0.64255625,
		0.64393222,
		0.64530712,
		0.64668113,
		0.64805406,
		0.64942598,
		0.65079689,
		0.65216672,
		0.65353554,
		0.65490329,
		0.65626991,
		0.65763551,
		0.65899992,
		0.66036326,
		0.66172546,
		0.66308647,
		0.66444635,
		0.6658051,
		0.6671626,
		0.66851896,
		0.66987407,
		0.67122793,
		0.6725806,
		0.67393202,
		0.67528218,
		0.67663103,
		0.67797863,
		0.67932492,
		0.6806699,
		0.68201351,
		0.68335581,
		0.68469679,
		0.68603641,
		0.68737459,
		0.68871146,
		0.69004685,
		0.69138086,
		0.6927135,
		0.69404465,
		0.69537431,
		0.69670254,
		0.69802934,
		0.69935459,
		0.70067835,
		0.70200062,
		0.70332134,
		0.70464051,
		0.70595819,
		0.70727426,
		0.70858872,
		0.70990163,
		0.71121293,
		0.71252269,
		0.71383071,
		0.71513718,
		0.71644193,
		0.71774507,
		0.71904653,
		0.72034627,
		0.72164434,
		0.72294068,
		0.7242353,
		0.72552818,
		0.72681934,
		0.7281087,
		0.72939634,
		0.73068213,
		0.7319662,
		0.73324841,
		0.73452878,
		0.73580736,
		0.73708409,
		0.73835897,
		0.73963195,
		0.74090308,
		0.7421723,
		0.74343961,
		0.74470502,
		0.74596846,
		0.74722999,
		0.74848962,
		0.74974722,
		0.75100285,
		0.75225651,
		0.75350815,
		0.75475776,
		0.75600541,
		0.75725096,
		0.7584945,
		0.759736,
		0.76097542,
		0.76221269,
		0.76344794,
		0.7646811,
		0.76591206,
		0.76714098,
		0.76836771,
		0.76959229,
		0.77081472,
		0.77203494,
		0.77325302,
		0.7744689,
		0.77568257,
		0.77689397,
		0.77810317,
		0.77931017,
		0.78051484,
		0.7817173,
		0.78291744,
		0.78411531,
		0.78531092,
		0.78650415,
		0.78769511,
		0.78888375,
		0.79007,
		0.79125386,
		0.79243541,
		0.79361457,
		0.79479134,
		0.79596573,
		0.79713768,
		0.79830724,
		0.7994743,
		0.80063897,
		0.8018012,
		0.80296093,
		0.80411816,
		0.80527294,
		0.80642521,
		0.80757499,
		0.8087222,
		0.80986691,
		0.81100911,
		0.81214869,
		0.81328577,
		0.81442022,
		0.81555212,
		0.81668139,
		0.81780809,
		0.81893218,
		0.82005358,
		0.82117242,
		0.82228857,
		0.82340205,
		0.82451284,
		0.82562101,
		0.82672644,
		0.82782918,
		0.82892925,
		0.83002657,
		0.83112115,
		0.83221298,
		0.83330208,
		0.83438838,
		0.83547193,
		0.83655268,
		0.83763069,
		0.83870584,
		0.83977818,
		0.84084773,
		0.84191442,
		0.84297824,
		0.84403926,
		0.84509736,
		0.84615266,
		0.84720504,
		0.8482545,
		0.84930104,
		0.85034472,
		0.85138547,
		0.85242325,
		0.85345811,
		0.85449004,
		0.855519,
		0.85654491,
		0.85756791,
		0.85858792,
		0.8596049,
		0.86061889,
		0.86162984,
		0.86263776,
		0.86364269,
		0.86464453,
		0.86564332,
		0.86663902,
		0.86763167,
		0.86862123,
		0.86960769,
		0.87059098,
		0.87157124,
		0.87254834,
		0.87352234,
		0.87449318,
		0.87546086,
		0.87642539,
		0.87738675,
		0.87834489,
		0.87929988,
		0.88025171,
		0.88120025,
		0.88214564,
		0.88308781,
		0.88402671,
		0.88496238,
		0.88589478,
		0.88682395,
		0.88774985,
		0.88867247,
		0.88959181,
		0.89050788,
		0.8914206,
		0.89232999,
		0.8932361,
		0.89413893,
		0.89503837,
		0.89593446,
		0.89682722,
		0.89771658,
		0.8986026,
		0.89948523,
		0.90036446,
		0.90124035,
		0.90211278,
		0.90298182,
		0.90384746,
		0.90470964,
		0.90556836,
		0.90642369,
		0.90727556,
		0.90812391,
		0.90896887,
		0.9098103,
		0.91064829,
		0.91148275,
		0.91231376,
		0.91314119,
		0.91396517,
		0.91478556,
		0.91560251,
		0.91641581,
		0.91722566,
		0.91803193,
		0.91883463,
		0.91963375,
		0.92042929,
		0.92122126,
		0.92200965,
		0.9227944,
		0.92357558,
		0.92435312,
		0.92512709,
		0.92589736,
		0.92666405,
		0.92742705,
		0.92818642,
		0.92894214,
		0.92969424,
		0.93044257,
		0.93118733,
		0.93192834,
		0.93266565,
		0.93339926,
		0.93412918,
		0.9348554,
		0.93557787,
		0.93629664,
		0.93701166,
		0.93772298,
		0.93843049,
		0.9391343,
		0.9398343,
		0.9405306,
		0.94122303,
		0.94191176,
		0.94259667,
		0.94327778,
		0.94395512,
		0.94462866,
		0.94529837,
		0.94596422,
		0.94662631,
		0.94728452,
		0.94793892,
		0.9485895,
		0.94923615,
		0.94987905,
		0.95051801,
		0.9511531,
		0.95178437,
		0.95241171,
		0.95303524,
		0.95365477,
		0.95427048,
		0.95488226,
		0.95549017,
		0.95609409,
		0.95669413,
		0.95729029,
		0.95788246,
		0.9584707,
		0.95905501,
		0.95963538,
		0.96021175,
		0.9607842,
		0.96135271,
		0.96191722,
		0.96247774,
		0.96303427,
		0.96358687,
		0.96413541,
		0.96468002,
		0.96522057,
		0.96575719,
		0.96628976,
		0.96681827,
		0.96734279,
		0.96786332,
		0.9683798,
		0.96889222,
		0.96940058,
		0.96990496,
		0.97040522,
		0.97090149,
		0.97139364,
		0.97188175,
		0.9723658,
		0.97284579,
		0.97332168,
		0.97379351,
		0.97426122,
		0.97472489,
		0.97518438,
		0.97563982,
		0.97609115,
		0.97653842,
		0.97698152,
		0.97742051,
		0.97785538,
		0.97828615,
		0.97871274,
		0.97913522,
		0.97955358,
		0.97996777,
		0.98037785,
		0.98078376,
		0.9811855,
		0.98158312,
		0.98197657,
		0.98236585,
		0.98275095,
		0.98313189,
		0.98350865,
		0.98388124,
		0.98424965,
		0.9846139,
		0.98497391,
		0.98532975,
		0.98568135,
		0.98602885,
		0.98637205,
		0.98671108,
		0.98704594,
		0.98737657,
		0.98770297,
		0.98802513,
		0.98834306,
		0.98865682,
		0.98896635,
		0.98927158,
		0.98957264,
		0.98986948,
		0.99016201,
		0.99045038,
		0.99073446,
		0.9910143,
		0.99128985,
		0.99156123,
		0.99182832,
		0.99209112,
		0.99234968,
		0.99260402,
		0.99285406,
		0.99309981,
		0.99334133,
		0.99357855,
		0.99381155,
		0.99404019,
		0.9942646,
		0.99448478,
		0.99470061,
		0.99491215,
		0.99511945,
		0.99532241,
		0.99552113,
		0.99571556,
		0.99590564,
		0.99609149,
		0.99627298,
		0.99645019,
		0.99662316,
		0.99679178,
		0.99695605,
		0.99711609,
		0.99727178,
		0.99742317,
		0.99757028,
		0.99771303,
		0.99785149,
		0.99798566,
		0.99811548,
		0.99824101,
		0.99836218,
		0.99847907,
		0.99859166,
		0.9986999,
		0.99880379,
		0.99890339,
		0.9989987,
		0.99908966,
		0.99917626,
		0.99925858,
		0.99933654,
		0.99941015,
		0.99947947,
		0.99954444,
		0.99960512,
		0.99966145,
		0.99971342,
		0.9997611,
		0.99980444,
		0.99984342,
		0.99987811,
		0.99990845,
		0.99993443,
		0.99995613,
		0.99997348,
		0.99998647,
		0.99999511,
		0.99999946,
		0.99999946,
		0.99999511,
		0.99998647,
		0.99997348,
		0.99995613,
		0.99993443,
		0.99990845,
		0.99987811,
		0.99984342,
		0.99980444,
		0.9997611,
		0.99971342,
		0.99966145,
		0.99960512,
		0.99954444,
		0.99947947,
		0.99941015,
		0.99933654,
		0.99925858,
		0.99917626,
		0.99908966,
		0.9989987,
		0.99890339,
		0.99880379,
		0.9986999,
		0.99859166,
		0.99847907,
		0.99836218,
		0.99824101,
		0.99811548,
		0.99798566,
		0.99785149,
		0.99771303,
		0.99757028,
		0.99742317,
		0.99727178,
		0.99711609,
		0.99695605,
		0.99679178,
		0.99662316,
		0.99645019,
		0.99627298,
		0.99609149,
		0.99590564,
		0.99571556,
		0.99552113,
		0.99532241,
		0.99511945,
		0.99491215,
		0.99470061,
		0.99448478,
		0.9942646,
		0.99404019,
		0.99381155,
		0.99357855,
		0.99334133,
		0.99309981,
		0.99285406,
		0.99260402,
		0.99234968,
		0.99209112,
		0.99182832,
		0.99156123,
		0.99128985,
		0.9910143,
		0.99073446,
		0.99045038,
		0.99016201,
		0.98986948,
		0.98957264,
		0.98927158,
		0.98896635,
		0.98865682,
		0.98834306,
		0.98802513,
		0.98770297,
		0.98737657,
		0.98704594,
		0.98671108,
		0.98637205,
		0.98602885,
		0.98568135,
		0.98532975,
		0.98497391,
		0.9846139,
		0.98424965,
		0.98388124,
		0.98350865,
		0.98313189,
		0.98275095,
		0.98236585,
		0.98197657,
		0.98158312,
		0.9811855,
		0.98078376,
		0.98037785,
		0.97996777,
		0.97955358,
		0.97913522,
		0.97871274,
		0.97828615,
		0.97785538,
		0.97742051,
		0.97698152,
		0.97653842,
		0.97609115,
		0.97563982,
		0.97518438,
		0.97472489,
		0.97426122,
		0.97379351,
		0.97332168,
		0.97284579,
		0.9723658,
		0.97188175,
		0.97139364,
		0.97090149,
		0.97040522,
		0.96990496,
		0.96940058,
		0.96889222,
		0.9683798,
		0.96786332,
		0.96734279,
		0.96681827,
		0.96628976,
		0.96575719,
		0.96522057,
		0.96468002,
		0.96413541,
		0.96358687,
		0.96303427,
		0.96247774,
		0.96191722,
		0.96135271,
		0.9607842,
		0.96021175,
		0.95963538,
		0.95905501,
		0.9584707,
		0.95788246,
		0.95729029,
		0.95669413,
		0.95609409,
		0.95549017,
		0.95488226,
		0.95427048,
		0.95365477,
		0.95303524,
		0.95241171,
		0.95178437,
		0.9511531,
		0.95051801,
		0.94987905,
		0.94923615,
		0.9485895,
		0.94793892,
		0.94728452,
		0.94662631,
		0.94596422,
		0.94529837,
		0.94462866,
		0.94395512,
		0.94327778,
		0.94259667,
		0.94191176,
		0.94122303,
		0.9405306,
		0.9398343,
		0.9391343,
		0.93843049,
		0.93772298,
		0.93701166,
		0.93629664,
		0.93557787,
		0.9348554,
		0.93412918,
		0.93339926,
		0.93266565,
		0.93192834,
		0.93118733,
		0.93044257,
		0.92969424,
		0.92894214,
		0.92818642,
		0.92742705,
		0.92666405,
		0.92589736,
		0.92512709,
		0.92435312,
		0.92357558,
		0.9227944,
		0.92200965,
		0.92122126,
		0.92042929,
		0.91963375,
		0.91883463,
		0.91803193,
		0.91722566,
		0.91641581,
		0.91560251,
		0.91478556,
		0.91396517,
		0.91314119,
		0.91231376,
		0.91148275,
		0.91064829,
		0.9098103,
		0.90896887,
		0.90812391,
		0.90727556,
		0.90642369,
		0.90556836,
		0.90470964,
		0.90384746,
		0.90298182,
		0.90211278,
		0.90124035,
		0.90036446,
		0.89948523,
		0.8986026,
		0.89771658,
		0.89682722,
		0.89593446,
		0.89503837,
		0.89413893,
		0.8932361,
		0.89232999,
		0.8914206,
		0.89050788,
		0.88959181,
		0.88867247,
		0.88774985,
		0.88682395,
		0.88589478,
		0.88496238,
		0.88402671,
		0.88308781,
		0.88214564,
		0.88120025,
		0.88025171,
		0.87929988,
		0.87834489,
		0.87738675,
		0.87642539,
		0.87546086,
		0.87449318,
		0.87352234,
		0.87254834,
		0.87157124,
		0.87059098,
		0.86960769,
		0.86862123,
		0.86763167,
		0.86663902,
		0.86564332,
		0.86464453,
		0.86364269,
		0.86263776,
		0.86162984,
		0.86061889,
		0.8596049,
		0.85858792,
		0.85756791,
		0.85654491,
		0.855519,
		0.85449004,
		0.85345811,
		0.85242325,
		0.85138547,
		0.85034472,
		0.84930104,
		0.8482545,
		0.84720504,
		0.84615266,
		0.84509736,
		0.84403926,
		0.84297824,
		0.84191442,
		0.84084773,
		0.83977818,
		0.83870584,
		0.83763069,
		0.83655268,
		0.83547193,
		0.83438838,
		0.83330208,
		0.83221298,
		0.83112115,
		0.83002657,
		0.82892925,
		0.82782918,
		0.82672644,
		0.82562101,
		0.82451284,
		0.82340205,
		0.82228857,
		0.82117242,
		0.82005358,
		0.81893218,
		0.81780809,
		0.81668139,
		0.81555212,
		0.81442022,
		0.81328577,
		0.81214869,
		0.81100911,
		0.80986691,
		0.8087222,
		0.80757499,
		0.80642521,
		0.80527294,
		0.80411816,
		0.80296093,
		0.8018012,
		0.80063897,
		0.7994743,
		0.79830724,
		0.79713768,
		0.79596573,
		0.79479134,
		0.79361457,
		0.79243541,
		0.79125386,
		0.79007,
		0.78888375,
		0.78769511,
		0.78650415,
		0.78531092,
		0.78411531,
		0.78291744,
		0.7817173,
		0.78051484,
		0.77931017,
		0.77810317,
		0.77689397,
		0.77568257,
		0.7744689,
		0.77325302,
		0.77203494,
		0.77081472,
		0.76959229,
		0.76836771,
		0.76714098,
		0.76591206,
		0.7646811,
		0.76344794,
		0.76221269,
		0.76097542,
		0.759736,
		0.7584945,
		0.75725096,
		0.75600541,
		0.75475776,
		0.75350815,
		0.75225651,
		0.75100285,
		0.74974722,
		0.74848962,
		0.74722999,
		0.74596846,
		0.74470502,
		0.74343961,
		0.7421723,
		0.74090308,
		0.73963195,
		0.73835897,
		0.73708409,
		0.73580736,
		0.73452878,
		0.73324841,
		0.7319662,
		0.73068213,
		0.72939634,
		0.7281087,
		0.72681934,
		0.72552818,
		0.7242353,
		0.72294068,
		0.72164434,
		0.72034627,
		0.71904653,
		0.71774507,
		0.71644193,
		0.71513718,
		0.71383071,
		0.71252269,
		0.71121293,
		0.70990163,
		0.70858872,
		0.70727426,
		0.70595819,
		0.70464051,
		0.70332134,
		0.70200062,
		0.70067835,
		0.69935459,
		0.69802934,
		0.69670254,
		0.69537431,
		0.69404465,
		0.6927135,
		0.69138086,
		0.69004685,
		0.68871146,
		0.68737459,
		0.68603641,
		0.68469679,
		0.68335581,
		0.68201351,
		0.6806699,
		0.67932492,
		0.67797863,
		0.67663103,
		0.67528218,
		0.67393202,
		0.6725806,
		0.67122793,
		0.66987407,
		0.66851896,
		0.6671626,
		0.6658051,
		0.66444635,
		0.66308647,
		0.66172546,
		0.66036326,
		0.65899992,
		0.65763551,
		0.65626991,
		0.65490329,
		0.65353554,
		0.65216672,
		0.65079689,
		0.64942598,
		0.64805406,
		0.64668113,
		0.64530712,
		0.64393222,
		0.64255625,
		0.64117938,
		0.6398015,
		0.63842273,
		0.637043,
		0.63566238,
		0.63428086,
		0.63289845,
		0.63151515,
		0.63013101,
		0.62874597,
		0.62736017,
		0.62597346,
		0.62458599,
		0.62319773,
		0.62180871,
		0.62041885,
		0.61902827,
		0.61763692,
		0.61624491,
		0.61485213,
		0.61345863,
		0.61206442,
		0.61066961,
		0.60927409,
		0.60787791,
		0.60648108,
		0.60508364,
		0.60368562,
		0.60228693,
		0.60088772,
		0.5994879,
		0.59808749,
		0.5966866,
		0.59528512,
		0.59388316,
		0.59248066,
		0.59107769,
		0.58967423,
		0.58827031,
		0.58686596,
		0.58546114,
		0.58405584,
		0.58265018,
		0.58124411,
		0.57983768,
		0.57843083,
		0.57702363,
		0.57561612,
		0.5742082,
		0.57280004,
		0.57139152,
		0.56998271,
		0.56857359,
		0.56716424,
		0.56575465,
		0.56434476,
		0.5629347,
		0.56152439,
		0.56011391,
		0.55870318,
		0.55729234,
		0.55588132,
		0.55447012,
		0.5530588,
		0.55164737,
		0.55023581,
		0.54882413,
		0.54741246,
		0.5460006,
		0.54458874,
		0.54317689,
		0.54176491,
		0.540353,
		0.53894103,
		0.53752911,
		0.5361172,
		0.53470528,
		0.53329349,
		0.53188169,
		0.53047001,
		0.5290584,
		0.5276469,
		0.52623552,
		0.52482426,
		0.52341318,
		0.52200222,
		0.52059144,
		0.51918083,
		0.51777041,
		0.51636022,
		0.51495028,
		0.51354051,
		0.51213104,
		0.5107218,
		0.50931287,
		0.50790417,
		0.50649583,
		0.50508779,
		0.50368011,
		0.50227273,
		0.5008657,
		0.49945906,
		0.49805278,
		0.49664691,
		0.49524146,
		0.49383643,
		0.49243182,
		0.49102765,
		0.48962396,
		0.48822075,
		0.48681802,
		0.48541579,
		0.48401406,
		0.48261288,
		0.48121223,
		0.47981215,
		0.4784126,
		0.47701365,
		0.47561529,
		0.47421756,
		0.47282043,
		0.47142392,
		0.4700281,
		0.46863291,
		0.4672384,
		0.46584454,
		0.46445143,
		0.46305901,
		0.4616673,
		0.46027634,
		0.45888615,
		0.4574967,
		0.45610803,
		0.45472014,
		0.45333308,
		0.45194682,
		0.4505614,
		0.44917682,
		0.4477931,
		0.44641024,
		0.44502825,
		0.44364718,
		0.442267,
		0.44088775,
		0.43950942,
		0.43813205,
		0.43675566,
		0.43538019,
		0.43400574,
		0.4326323,
		0.43125984,
		0.42988843,
		0.42851806,
		0.42714873,
		0.42578045,
		0.42441326,
		0.42304716,
		0.42168215,
		0.42031828,
		0.4189555,
		0.4175939,
		0.41623342,
		0.41487411,
		0.41351599,
		0.41215909,
		0.41080335,
		0.40944883,
		0.40809557,
		0.40674353,
		0.40539274,
		0.40404323,
		0.402695,
		0.40134808,
		0.40000245,
		0.39865813,
		0.39731514,
		0.3959735,
		0.39463323,
		0.39329433,
		0.39195681,
		0.39062068,
		0.38928595,
		0.38795266,
		0.38662076,
		0.38529035,
		0.38396138,
		0.38263386,
		0.38130787,
		0.37998334,
		0.37866032,
		0.37733883,
		0.37601888,
		0.37470046,
		0.37338361,
		0.37206832,
		0.3707546,
		0.36944249,
		0.368132,
		0.36682311,
		0.36551586,
		0.36421025,
		0.36290628,
		0.36160401,
		0.3603034,
		0.3590045,
		0.35770729,
		0.35641178,
		0.35511804,
		0.35382602,
		0.35253575,
		0.35124725,
		0.34996054,
		0.34867561,
		0.34739247,
		0.34611118,
		0.34483168,
		0.34355405,
		0.34227824,
		0.34100431,
		0.33973226,
		0.33846208,
		0.33719382,
		0.33592746,
		0.334663,
		0.33340052,
		0.33213997,
		0.33088136,
		0.32962474,
		0.32837009,
		0.32711744,
		0.32586679,
		0.32461816,
		0.32337156,
		0.32212698,
		0.3208845,
		0.31964403,
		0.31840569,
		0.3171694,
		0.31593522,
		0.31470317,
		0.31347322,
		0.3122454,
		0.31101975,
		0.30979624,
		0.30857489,
		0.30735573,
		0.30613878,
		0.30492401,
		0.30371147,
		0.30250114,
		0.30129305,
		0.30008721,
		0.29888365,
		0.29768234,
		0.29648331,
		0.2952866,
		0.29409218,
		0.29290006,
		0.29171029,
		0.29052287,
		0.28933778,
		0.28815505,
		0.2869747,
		0.28579673,
		0.28462115,
		0.28344798,
		0.28227726,
		0.28110892,
		0.27994305,
		0.2787796,
		0.27761865,
		0.27646014,
		0.27530414,
		0.27415061,
		0.27299958,
		0.27185109,
		0.2707051,
		0.26956168,
		0.26842079,
		0.26728246,
		0.26614669,
		0.26501352,
		0.26388291,
		0.26275492,
		0.26162955,
		0.26050681,
		0.25938669,
		0.25826919,
		0.25715438,
		0.25604221,
		0.25493273,
		0.25382593,
		0.25272185,
		0.25162044,
		0.25052178,
		0.24942581,
		0.2483326,
		0.24724214,
		0.24615443,
		0.24506949,
		0.24398734,
		0.24290797,
		0.24183139,
		0.24075763,
		0.2396867,
		0.23861858,
		0.2375533,
		0.23649088,
		0.23543131,
		0.23437463,
		0.2333208,
		0.23226988,
		0.23122185,
		0.23017673,
		0.22913453,
		0.22809526,
		0.22705893,
		0.22602555,
		0.22499514,
		0.22396767,
		0.22294319,
		0.2219217,
		0.2209032,
		0.21988772,
		0.21887524,
		0.21786579,
		0.21685939,
		0.21585602,
		0.2148557,
		0.21385846,
		0.21286428,
		0.21187317,
		0.21088518,
		0.20990027,
		0.20891848,
		0.2079398,
		0.20696425,
		0.20599185,
		0.20502259,
		0.20405649,
		0.20309354,
		0.20213379,
		0.20117719,
		0.20022382,
		0.19927362,
		0.19832665,
		0.19738288,
		0.19644235,
		0.19550505,
		0.194571,
		0.19364022,
		0.19271268,
		0.19178842,
		0.19086745,
		0.18994975,
		0.18903537,
		0.18812428,
		0.18721652,
		0.18631206,
		0.18541096,
		0.18451318,
		0.18361875,
		0.18272769,
		0.18183999,
		0.18095566,
		0.18007472,
		0.17919718,
		0.17832303,
		0.17745228,
		0.17658496,
		0.17572105,
		0.17486058,
		0.17400354,
		0.17314996,
		0.17229983,
		0.17145316,
		0.17060998,
		0.16977027,
		0.16893405,
		0.16810131,
		0.16727209,
		0.16644639,
		0.16562419,
		0.16480553,
		0.16399039,
		0.16317882,
		0.16237077,
		0.1615663,
		0.16076538,
		0.15996805,
		0.15917428,
		0.15838411,
		0.15759754,
		0.15681456,
		0.1560352,
		0.15525945,
		0.15448733,
		0.15371884,
		0.152954,
		0.15219279,
		0.15143524,
		0.15068135,
		0.14993113,
		0.14918458,
		0.14844173,
		0.14770254,
		0.14696707,
		0.1462353,
		0.14550723,
		0.14478289,
		0.14406227,
		0.14334537,
		0.14263222,
		0.1419228,
		0.14121713,
		0.14051522,
		0.13981709,
		0.13912271,
		0.13843212,
		0.13774531,
		0.13706228,
		0.13638306,
		0.13570765,
		0.13503602,
		0.13436823,
		0.13370426,
		0.13304411,
		0.13238779,
		0.13173531,
		0.13108669,
		0.13044192,
		0.12980101,
		0.12916395,
		0.12853077,
		0.12790146,
		0.12727605,
		0.12665451,
		0.12603687,
		0.12542313,
		0.1248133,
		0.12420738,
		0.12360538,
		0.1230073,
		0.12241315,
		0.12182293,
		0.12123665,
		0.12065432,
		0.12007594,
		0.11950152,
		0.11893106,
		0.11836456,
		0.11780204,
		0.11724349,
		0.11668893,
		0.11613835,
		0.11559177,
		0.11504919,
		0.11451062,
		0.11397605,
		0.11344549,
		0.11291895,
		0.11239644,
		0.11187796,
		0.11136351,
		0.11085309,
		0.11034673,
		0.1098444,
		0.10934614,
		0.10885192,
		0.10836177,
		0.1078757,
		0.10739368,
		0.10691575,
		0.10644189,
		0.10597213,
		0.10550644,
		0.10504486,
		0.10458737,
		0.10413399,
		0.1036847,
		0.10323954,
		0.10279848,
		0.10236154,
		0.10192873,
		0.10150005,
		0.10107549,
		0.10065508,
		0.1002388,
		0.099826664,
		0.099418677,
		0.099014841,
		0.098615155,
		0.098219633,
		0.097828269,
		0.097441077,
		0.09705805,
		0.096679196,
		0.096304521,
		0.095934026,
		0.095567711,
		0.09520559,
		0.094847649,
		0.094493911,
		0.094144367,
		0.093799025,
		0.093457893,
		0.093120962,
		0.092788242,
		0.092459731,
		0.092135444,
		0.091815367,
		0.091499522,
		0.091187902,
		0.090880506,
		0.090577342,
		0.090278409,
		0.089983724,
		0.089693271,
		0.089407064,
		0.089125097,
		0.088847384,
		0.088573918,
		0.088304706,
		0.088039748,
		0.087779053,
		0.087522611,
		0.087270439,
		0.087022528,
		0.086778887,
		0.086539514,
		0.086304419,
		0.086073592,
		0.085847043,
		0.085624777,
		0.085406788,
		0.085193083,
		0.084983662,
		0.084778532,
		0.084577687,
		0.084381133,
		0.084188871,
		0.084000908,
		0.083817236,
		0.083637863,
		0.08346279,
		0.083292022,
		0.083125554,
		0.082963385,
		0.082805529,
		0.08265198,
		0.082502738,
		0.082357809,
		0.082217187,
		0.082080886,
		0.081948891,
		0.081821218,
		0.081697851,
		0.081578813,
		0.081464089,
		0.081353687,
		0.081247605,
		0.081145845,
		0.081048414,
		0.080955304,
		0.080866516,
		0.080782056,
		0.080701917,
		0.080626108,
		0.080554634,
		0.080487482,
		0.080424659,
		0.080366172,
		0.080312006,
		0.080262177,
		0.080216676,
		0.080175512,
		0.080138676,
		0.080106176,
		0.080078006,
		0.080054171,
		0.080034673,
		0.080019504,
		0.080008671,
		0.080002166,
		0.079999998,

};

float32_t mel=0,ftemp=0;
uint16_t f[NFILT+2]={0};



/* tFiltInit costruisce i filtri triangolari e li infila in due vettori
 * e inoltre costruisce gli handle per ogni filtro
 */
void tFiltInit()
{
	float32_t Mstart = 1125*logf(1+((float32_t)FSTART/700));
	float32_t Mstop = 1125*logf(1+((float32_t)FSTOP/700));



	for (int var = 0; var < NFILT+2; ++var)
	{
		mel=Mstart+(Mstop-Mstart)*var/(NFILT+1);
		ftemp=700*(expf(mel/1125)-1);
		f[var]=floorf((float32_t)(NFFT+1)*(float32_t)ftemp / FS);
	}

	for (int m = 1; m< NFILT+1; m=m+2) 		// calcola due filtri per ogni ciclo
	{										// da salvare in vettori diversi per
		hfilt[m-1].fstart=f[m-1];			// evitare sovrapposizioni
		hfilt[m-1].len=f[m+1]-f[m-1];
		hfilt[m-1].fdata=&dispari[f[m-1]];

		for (int k = f[m-1]; k < f[m]; ++k)	// ramo in salita del primo
		{
			dispari[k]=(float32_t)(k-f[m-1]) / (float32_t)(f[m] - f[m - 1]);
		}
		for (int k = f[m]; k < f[m+1]; ++k)	// ramo in discesa del primo
		{
			dispari[k]=(float32_t)(f[m+1]-k) / (float32_t)(f[m+1] - f[m]);
		}



		hfilt[m].fstart=f[m];
		hfilt[m].len=f[m+2]-f[m];
		hfilt[m].fdata=&pari[f[m]];
		for (int k = f[m]; k < f[m+1]; ++k)		// ramo in salita del secondo
		{
			pari[k]=(float32_t)(k-f[m]) / (float32_t)(f[m+1] - f[m]);
		}
		for (int k = f[m+1]; k < f[m+2]; ++k)	// ramo in discesa del secondo
		{
			pari[k]=(float32_t)(f[m+2]-k) / (float32_t)(f[m+2] - f[m+1]);
		}


	}

	parametriDCT();
}


/* Calcola lo spettro di potenza di un frame
 * pIn: 	puntatore al frame da calcolare
 * len: 	lunghezza del frame (deve essere una potenza di due)
 * pOut: 	puntatore al buffer di uscita, lungo 1+len/2
 */
float32_t buffero[2050], buffera[2048];
void powerSpectrum(float32_t * pIn, uint16_t len, float32_t * pOut)
{
	arm_fir_init_f32(&prem,2,tappi,prestato,len);
	arm_mult_f32(pIn,hamwin2048,buffero,len);
	arm_fir_f32(&prem,buffero,buffera,len);				// pre enfasi

	arm_rfft_fast_instance_f32 hfft;

	arm_rfft_fast_init_f32(&hfft,len);

	arm_rfft_fast_f32(&hfft,buffera,buffero,0);

	buffero[len]=buffero[1];
	buffero[1]=0.0f;
	buffero[len+1]=0.0f;

	arm_cmplx_mag_squared_f32(buffero,pOut,1+len/2);	// calcola il modulo^2 della FFT
	arm_scale_f32(pOut,1.0f/(float32_t)len ,pOut,1+len/2);	// divide per len

}

/* applica i filtri calcolati al frame e calcola gli MFCC (da finire)
 * pIn: 	puntatore al frame
 * pOut: 	puntatore al buffer di uscita, lungo nFilt
 * inLen: 	lunghezza del frame
 * nFilt:	numero di filtri
 * filtri:	puntatore all'array di handle dei filtri
 */
void filtraggi(
		float32_t * pIn,
		float32_t * pOut,
		uint16_t inLen,
		uint16_t nFilt,
		ftri_handle * filtri)
{
	float32_t temp[257],filtrato[257],temp2[NFILT];

	for (int n = 0; n < nFilt; ++n) {

		arm_fill_f32(0.0f,temp,inLen);	// riempie l'array temp di 0
		arm_copy_f32((filtri+n)->fdata,&temp[(filtri+n)->fstart],(filtri+n)->len);
		// copia il filtro ennesimo in temp al punto giusto

		arm_mult_f32(pIn,temp,filtrato,inLen); 	// applica il filtro temp a pIn
		*(temp2+n)=0;
		for (int i = 0; i < inLen; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n)+=*(filtrato+i);

		}
		*(temp2+n)=logf(*(temp2+n));
	}

	arm_matrix_instance_f32 DCTPMat={NFILT, NFILT, DCTParam};
	arm_matrix_instance_f32 DCTin={NFILT,1,temp2};
	arm_matrix_instance_f32 DCTout={NFILT,1,pOut};

	arm_mat_mult_f32(&DCTPMat, &DCTin,&DCTout);
}

/* applica i filtri calcolati al frame e calcola gli MFCC
 * pIn: 	puntatore al frame
 * pOut: 	puntatore al buffer di uscita, lungo nFilt
 * inLen: 	lunghezza del frame
 * nFilt:	numero di filtri
 * filtri:	puntatore all'array di handle dei filtri
 */
void estrazione(
		float32_t * pIn,
		float32_t * pOut,
		uint16_t inLen,
		uint16_t nFilt,
		ftri_handle * filtri)
{
	float32_t tempdisp[1+NFFT/2],temppari[1+NFFT/2],filtrato[1+NFFT/2],temp2[NFILT];

	arm_mult_f32(pIn,dispari,tempdisp,inLen);
	arm_mult_f32(pIn,pari,temppari,inLen);

	for (int n = 0; n < nFilt; n+=2) {

		arm_fill_f32(0.0f,filtrato,inLen);	// riempie l'array temp di 0
		arm_copy_f32(&(tempdisp[(filtri+n)->fstart]),&filtrato[(filtri+n)->fstart],(filtri+n)->len);

		*(temp2+n)=0;
		for (int i = 0; i < inLen; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n)+=*(filtrato+i);

		}
		*(temp2+n)=log10f(*(temp2+n));





		arm_fill_f32(0.0f,filtrato,inLen);	// riempie l'array temp di 0
		arm_copy_f32(&(temppari[(filtri+n+1)->fstart]),&filtrato[(filtri+n+1)->fstart],(filtri+n+1)->len);
		// copia il filtro ennesimo in temp al punto giusto
		*(temp2+n+1)=0;
		for (int i = 0; i < inLen; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n+1)+=*(filtrato+i);

		}
		*(temp2+n+1)=log10f(*(temp2+n+1));
	}

	arm_matrix_instance_f32 DCTPMat={NFILT, NFILT, DCTParam};
	arm_matrix_instance_f32 DCTin={NFILT,1,temp2};
	arm_matrix_instance_f32 DCTout={NFILT,1,pOut};

	arm_mat_mult_f32(&DCTPMat, &DCTin,&DCTout);
}


void prenfasi()
{

}

void estrazione2(
		float32_t * pIn,
		float32_t * pOut,
		uint16_t inLen,
		uint16_t nFilt,
		ftri_handle * filtri)
{
	float32_t tempdisp[1+NFFT/2],temppari[1+NFFT/2],/*filtrato[1+NFFT/2],*/temp2[NFILT];

	arm_mult_f32(pIn,dispari,tempdisp,inLen);
	arm_mult_f32(pIn,pari,temppari,inLen);

	for (int n = 0; n < nFilt; n+=2) {

		//arm_fill_f32(0.0f,filtrato,inLen);	// riempie l'array temp di 0
		//arm_copy_f32(&(tempdisp[(filtri+n)->fstart]),&filtrato[(filtri+n)->fstart],(filtri+n)->len);

		*(temp2+n)=0;
		for (int i = 0; i < (filtri+n)->len; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n)+=*(tempdisp+i+(filtri+n)->fstart);

		}
		*(temp2+n)=logf(*(temp2+n));





		//arm_fill_f32(0.0f,filtrato,inLen);	// riempie l'array temp di 0
		//arm_copy_f32(&(temppari[(filtri+n+1)->fstart]),&filtrato[(filtri+n+1)->fstart],(filtri+n+1)->len);
		// copia il filtro ennesimo in temp al punto giusto
		*(temp2+n+1)=0;
		for (int i = 0; i < (filtri+n+1)->len; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n+1)+=*(temppari+i+(filtri+n+1)->fstart);

		}
		*(temp2+n+1)=logf(*(temp2+n+1));
	}

	arm_matrix_instance_f32 DCTPMat={NFILT, NFILT, DCTParam};
	arm_matrix_instance_f32 DCTin={NFILT,1,temp2};
	arm_matrix_instance_f32 DCTout={NFILT,1,pOut};

	arm_mat_mult_f32(&DCTPMat, &DCTin,&DCTout);
}



void parametriDCT()
{

	for (int k = 0; k < NFILT; ++k)
	{
		for (int n = 0; n < NFILT; ++n)
		{
			DCTParam[(k*26)+n]=arm_cos_f32(((float32_t)PI/(float32_t)NFILT)*(n+0.5f)*k);
		}
	}
}
