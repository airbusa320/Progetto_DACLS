/****************************************************************
 *  															*
 *   Cepstrum.c												*
 * 																*
 *    Created on: 24 mar 2018									*
 *        Author: Riccardo, Stefano								*
 *	 															*
 ****************************************************************

 ================================================================
                  ##### Estrazione MFCC #####
 ================================================================

 Modificare la definizione FSTART, FSTOP, FS, NFFT, NFILT in
 accordo alle proprie esigenze.

 La funzione tFiltInit costruisce il banco filtri MEL e calcola
 i coefficienti per il calcolo della DCT.

 La funzione estrazione calcola i coefficienti MFCC relativi
 al frame passato in ingresso.
 */


#include "Cepstrum.h"

#include "math.h"
#include "arm_const_structs.h"
#include "tim.h"


const float32_t tappi[]={-0.97, 1};

/* =====================================================
 *
 * Finestre di hamming
 * (1-alfa)-alfa*cos(2*PI*n/(N-1)), 0<=n<=N-1
 * con alfa=0.46
 *
 * =====================================================
 */

const float32_t hamming_window_2048[] = {0.079999998, 0.080002166, 0.080008671, 0.080019504, 0.080034673, 0.080054171, 0.080078006, 0.080106176, 0.080138676, 0.080175512, 0.080216676, 0.080262177, 0.080312006, 0.080366172, 0.080424659, 0.080487482, 0.080554634, 0.080626108, 0.080701917, 0.080782056, 0.080866516, 0.080955304, 0.081048414, 0.081145845, 0.081247605, 0.081353687, 0.081464089, 0.081578813, 0.081697851, 0.081821218, 0.081948891, 0.082080886, 0.082217187, 0.082357809, 0.082502738, 0.08265198, 0.082805529, 0.082963385, 0.083125554, 0.083292022, 0.08346279, 0.083637863, 0.083817236, 0.084000908, 0.084188871, 0.084381133, 0.084577687, 0.084778532, 0.084983662, 0.085193083, 0.085406788, 0.085624777, 0.085847043, 0.086073592, 0.086304419, 0.086539514, 0.086778887, 0.087022528, 0.087270439, 0.087522611, 0.087779053, 0.088039748, 0.088304706, 0.088573918, 0.088847384, 0.089125097, 0.089407064, 0.089693271, 0.089983724, 0.090278409, 0.090577342, 0.090880506, 0.091187902, 0.091499522, 0.091815367, 0.092135444, 0.092459731, 0.092788242, 0.093120962, 0.093457893, 0.093799025, 0.094144367, 0.094493911, 0.094847649, 0.09520559, 0.095567711, 0.095934026, 0.096304521, 0.096679196, 0.09705805, 0.097441077, 0.097828269, 0.098219633, 0.098615155, 0.099014841, 0.099418677, 0.099826664, 0.1002388, 0.10065508, 0.10107549, 0.10150005, 0.10192873, 0.10236154, 0.10279848, 0.10323954, 0.1036847, 0.10413399, 0.10458737, 0.10504486, 0.10550644, 0.10597213, 0.10644189, 0.10691575, 0.10739368, 0.1078757, 0.10836177, 0.10885192, 0.10934614, 0.1098444, 0.11034673, 0.11085309, 0.11136351, 0.11187796, 0.11239644, 0.11291895, 0.11344549, 0.11397605, 0.11451062, 0.11504919, 0.11559177, 0.11613835, 0.11668893, 0.11724349, 0.11780204, 0.11836456, 0.11893106, 0.11950152, 0.12007594, 0.12065432, 0.12123665, 0.12182293, 0.12241315, 0.1230073, 0.12360538, 0.12420738, 0.1248133, 0.12542313, 0.12603687, 0.12665451, 0.12727605, 0.12790146, 0.12853077, 0.12916395, 0.12980101, 0.13044192, 0.13108669, 0.13173531, 0.13238779, 0.13304411, 0.13370426, 0.13436823, 0.13503602, 0.13570765, 0.13638306, 0.13706228, 0.13774531, 0.13843212, 0.13912271, 0.13981709, 0.14051522, 0.14121713, 0.1419228, 0.14263222, 0.14334537, 0.14406227, 0.14478289, 0.14550723, 0.1462353, 0.14696707, 0.14770254, 0.14844173, 0.14918458, 0.14993113, 0.15068135, 0.15143524, 0.15219279, 0.152954, 0.15371884, 0.15448733, 0.15525945, 0.1560352, 0.15681456, 0.15759754, 0.15838411, 0.15917428, 0.15996805, 0.16076538, 0.1615663, 0.16237077, 0.16317882, 0.16399039, 0.16480553, 0.16562419, 0.16644639, 0.16727209, 0.16810131, 0.16893405, 0.16977027, 0.17060998, 0.17145316, 0.17229983, 0.17314996, 0.17400354, 0.17486058, 0.17572105, 0.17658496, 0.17745228, 0.17832303, 0.17919718, 0.18007472, 0.18095566, 0.18183999, 0.18272769, 0.18361875, 0.18451318, 0.18541096, 0.18631206, 0.18721652, 0.18812428, 0.18903537, 0.18994975, 0.19086745, 0.19178842, 0.19271268, 0.19364022, 0.194571, 0.19550505, 0.19644235, 0.19738288, 0.19832665, 0.19927362, 0.20022382, 0.20117719, 0.20213379, 0.20309354, 0.20405649, 0.20502259, 0.20599185, 0.20696425, 0.2079398, 0.20891848, 0.20990027, 0.21088518, 0.21187317, 0.21286428, 0.21385846, 0.2148557, 0.21585602, 0.21685939, 0.21786579, 0.21887524, 0.21988772, 0.2209032, 0.2219217, 0.22294319, 0.22396767, 0.22499514, 0.22602555, 0.22705893, 0.22809526, 0.22913453, 0.23017673, 0.23122185, 0.23226988, 0.2333208, 0.23437463, 0.23543131, 0.23649088, 0.2375533, 0.23861858, 0.2396867, 0.24075763, 0.24183139, 0.24290797, 0.24398734, 0.24506949, 0.24615443, 0.24724214, 0.2483326, 0.24942581, 0.25052178, 0.25162044, 0.25272185, 0.25382593, 0.25493273, 0.25604221, 0.25715438, 0.25826919, 0.25938669, 0.26050681, 0.26162955, 0.26275492, 0.26388291, 0.26501352, 0.26614669, 0.26728246, 0.26842079, 0.26956168, 0.2707051, 0.27185109, 0.27299958, 0.27415061, 0.27530414, 0.27646014, 0.27761865, 0.2787796, 0.27994305, 0.28110892, 0.28227726, 0.28344798, 0.28462115, 0.28579673, 0.2869747, 0.28815505, 0.28933778, 0.29052287, 0.29171029, 0.29290006, 0.29409218, 0.2952866, 0.29648331, 0.29768234, 0.29888365, 0.30008721, 0.30129305, 0.30250114, 0.30371147, 0.30492401, 0.30613878, 0.30735573, 0.30857489, 0.30979624, 0.31101975, 0.3122454, 0.31347322, 0.31470317, 0.31593522, 0.3171694, 0.31840569, 0.31964403, 0.3208845, 0.32212698, 0.32337156, 0.32461816, 0.32586679, 0.32711744, 0.32837009, 0.32962474, 0.33088136, 0.33213997, 0.33340052, 0.334663, 0.33592746, 0.33719382, 0.33846208, 0.33973226, 0.34100431, 0.34227824, 0.34355405, 0.34483168, 0.34611118, 0.34739247, 0.34867561, 0.34996054, 0.35124725, 0.35253575, 0.35382602, 0.35511804, 0.35641178, 0.35770729, 0.3590045, 0.3603034, 0.36160401, 0.36290628, 0.36421025, 0.36551586, 0.36682311, 0.368132, 0.36944249, 0.3707546, 0.37206832, 0.37338361, 0.37470046, 0.37601888, 0.37733883, 0.37866032, 0.37998334, 0.38130787, 0.38263386, 0.38396138, 0.38529035, 0.38662076, 0.38795266, 0.38928595, 0.39062068, 0.39195681, 0.39329433, 0.39463323, 0.3959735, 0.39731514, 0.39865813, 0.40000245, 0.40134808, 0.402695, 0.40404323, 0.40539274, 0.40674353, 0.40809557, 0.40944883, 0.41080335, 0.41215909, 0.41351599, 0.41487411, 0.41623342, 0.4175939, 0.4189555, 0.42031828, 0.42168215, 0.42304716, 0.42441326, 0.42578045, 0.42714873, 0.42851806, 0.42988843, 0.43125984, 0.4326323, 0.43400574, 0.43538019, 0.43675566, 0.43813205, 0.43950942, 0.44088775, 0.442267, 0.44364718, 0.44502825, 0.44641024, 0.4477931, 0.44917682, 0.4505614, 0.45194682, 0.45333308, 0.45472014, 0.45610803, 0.4574967, 0.45888615, 0.46027634, 0.4616673, 0.46305901, 0.46445143, 0.46584454, 0.4672384, 0.46863291, 0.4700281, 0.47142392, 0.47282043, 0.47421756, 0.47561529, 0.47701365, 0.4784126, 0.47981215, 0.48121223, 0.48261288, 0.48401406, 0.48541579, 0.48681802, 0.48822075, 0.48962396, 0.49102765, 0.49243182, 0.49383643, 0.49524146, 0.49664691, 0.49805278, 0.49945906, 0.5008657, 0.50227273, 0.50368011, 0.50508779, 0.50649583, 0.50790417, 0.50931287, 0.5107218, 0.51213104, 0.51354051, 0.51495028, 0.51636022, 0.51777041, 0.51918083, 0.52059144, 0.52200222, 0.52341318, 0.52482426, 0.52623552, 0.5276469, 0.5290584, 0.53047001, 0.53188169, 0.53329349, 0.53470528, 0.5361172, 0.53752911, 0.53894103, 0.540353, 0.54176491, 0.54317689, 0.54458874, 0.5460006, 0.54741246, 0.54882413, 0.55023581, 0.55164737, 0.5530588, 0.55447012, 0.55588132, 0.55729234, 0.55870318, 0.56011391, 0.56152439, 0.5629347, 0.56434476, 0.56575465, 0.56716424, 0.56857359, 0.56998271, 0.57139152, 0.57280004, 0.5742082, 0.57561612, 0.57702363, 0.57843083, 0.57983768, 0.58124411, 0.58265018, 0.58405584, 0.58546114, 0.58686596, 0.58827031, 0.58967423, 0.59107769, 0.59248066, 0.59388316, 0.59528512, 0.5966866, 0.59808749, 0.5994879, 0.60088772, 0.60228693, 0.60368562, 0.60508364, 0.60648108, 0.60787791, 0.60927409, 0.61066961, 0.61206442, 0.61345863, 0.61485213, 0.61624491, 0.61763692, 0.61902827, 0.62041885, 0.62180871, 0.62319773, 0.62458599, 0.62597346, 0.62736017, 0.62874597, 0.63013101, 0.63151515, 0.63289845, 0.63428086, 0.63566238, 0.637043, 0.63842273, 0.6398015, 0.64117938, 0.64255625, 0.64393222, 0.64530712, 0.64668113, 0.64805406, 0.64942598, 0.65079689, 0.65216672, 0.65353554, 0.65490329, 0.65626991, 0.65763551, 0.65899992, 0.66036326, 0.66172546, 0.66308647, 0.66444635, 0.6658051, 0.6671626, 0.66851896, 0.66987407, 0.67122793, 0.6725806, 0.67393202, 0.67528218, 0.67663103, 0.67797863, 0.67932492, 0.6806699, 0.68201351, 0.68335581, 0.68469679, 0.68603641, 0.68737459, 0.68871146, 0.69004685, 0.69138086, 0.6927135, 0.69404465, 0.69537431, 0.69670254, 0.69802934, 0.69935459, 0.70067835, 0.70200062, 0.70332134, 0.70464051, 0.70595819, 0.70727426, 0.70858872, 0.70990163, 0.71121293, 0.71252269, 0.71383071, 0.71513718, 0.71644193, 0.71774507, 0.71904653, 0.72034627, 0.72164434, 0.72294068, 0.7242353, 0.72552818, 0.72681934, 0.7281087, 0.72939634, 0.73068213, 0.7319662, 0.73324841, 0.73452878, 0.73580736, 0.73708409, 0.73835897, 0.73963195, 0.74090308, 0.7421723, 0.74343961, 0.74470502, 0.74596846, 0.74722999, 0.74848962, 0.74974722, 0.75100285, 0.75225651, 0.75350815, 0.75475776, 0.75600541, 0.75725096, 0.7584945, 0.759736, 0.76097542, 0.76221269, 0.76344794, 0.7646811, 0.76591206, 0.76714098, 0.76836771, 0.76959229, 0.77081472, 0.77203494, 0.77325302, 0.7744689, 0.77568257, 0.77689397, 0.77810317, 0.77931017, 0.78051484, 0.7817173, 0.78291744, 0.78411531, 0.78531092, 0.78650415, 0.78769511, 0.78888375, 0.79007, 0.79125386, 0.79243541, 0.79361457, 0.79479134, 0.79596573, 0.79713768, 0.79830724, 0.7994743, 0.80063897, 0.8018012, 0.80296093, 0.80411816, 0.80527294, 0.80642521, 0.80757499, 0.8087222, 0.80986691, 0.81100911, 0.81214869, 0.81328577, 0.81442022, 0.81555212, 0.81668139, 0.81780809, 0.81893218, 0.82005358, 0.82117242, 0.82228857, 0.82340205, 0.82451284, 0.82562101, 0.82672644, 0.82782918, 0.82892925, 0.83002657, 0.83112115, 0.83221298, 0.83330208, 0.83438838, 0.83547193, 0.83655268, 0.83763069, 0.83870584, 0.83977818, 0.84084773, 0.84191442, 0.84297824, 0.84403926, 0.84509736, 0.84615266, 0.84720504, 0.8482545, 0.84930104, 0.85034472, 0.85138547, 0.85242325, 0.85345811, 0.85449004, 0.855519, 0.85654491, 0.85756791, 0.85858792, 0.8596049, 0.86061889, 0.86162984, 0.86263776, 0.86364269, 0.86464453, 0.86564332, 0.86663902, 0.86763167, 0.86862123, 0.86960769, 0.87059098, 0.87157124, 0.87254834, 0.87352234, 0.87449318, 0.87546086, 0.87642539, 0.87738675, 0.87834489, 0.87929988, 0.88025171, 0.88120025, 0.88214564, 0.88308781, 0.88402671, 0.88496238, 0.88589478, 0.88682395, 0.88774985, 0.88867247, 0.88959181, 0.89050788, 0.8914206, 0.89232999, 0.8932361, 0.89413893, 0.89503837, 0.89593446, 0.89682722, 0.89771658, 0.8986026, 0.89948523, 0.90036446, 0.90124035, 0.90211278, 0.90298182, 0.90384746, 0.90470964, 0.90556836, 0.90642369, 0.90727556, 0.90812391, 0.90896887, 0.9098103, 0.91064829, 0.91148275, 0.91231376, 0.91314119, 0.91396517, 0.91478556, 0.91560251, 0.91641581, 0.91722566, 0.91803193, 0.91883463, 0.91963375, 0.92042929, 0.92122126, 0.92200965, 0.9227944, 0.92357558, 0.92435312, 0.92512709, 0.92589736, 0.92666405, 0.92742705, 0.92818642, 0.92894214, 0.92969424, 0.93044257, 0.93118733, 0.93192834, 0.93266565, 0.93339926, 0.93412918, 0.9348554, 0.93557787, 0.93629664, 0.93701166, 0.93772298, 0.93843049, 0.9391343, 0.9398343, 0.9405306, 0.94122303, 0.94191176, 0.94259667, 0.94327778, 0.94395512, 0.94462866, 0.94529837, 0.94596422, 0.94662631, 0.94728452, 0.94793892, 0.9485895, 0.94923615, 0.94987905, 0.95051801, 0.9511531, 0.95178437, 0.95241171, 0.95303524, 0.95365477, 0.95427048, 0.95488226, 0.95549017, 0.95609409, 0.95669413, 0.95729029, 0.95788246, 0.9584707, 0.95905501, 0.95963538, 0.96021175, 0.9607842, 0.96135271, 0.96191722, 0.96247774, 0.96303427, 0.96358687, 0.96413541, 0.96468002, 0.96522057, 0.96575719, 0.96628976, 0.96681827, 0.96734279, 0.96786332, 0.9683798, 0.96889222, 0.96940058, 0.96990496, 0.97040522, 0.97090149, 0.97139364, 0.97188175, 0.9723658, 0.97284579, 0.97332168, 0.97379351, 0.97426122, 0.97472489, 0.97518438, 0.97563982, 0.97609115, 0.97653842, 0.97698152, 0.97742051, 0.97785538, 0.97828615, 0.97871274, 0.97913522, 0.97955358, 0.97996777, 0.98037785, 0.98078376, 0.9811855, 0.98158312, 0.98197657, 0.98236585, 0.98275095, 0.98313189, 0.98350865, 0.98388124, 0.98424965, 0.9846139, 0.98497391, 0.98532975, 0.98568135, 0.98602885, 0.98637205, 0.98671108, 0.98704594, 0.98737657, 0.98770297, 0.98802513, 0.98834306, 0.98865682, 0.98896635, 0.98927158, 0.98957264, 0.98986948, 0.99016201, 0.99045038, 0.99073446, 0.9910143, 0.99128985, 0.99156123, 0.99182832, 0.99209112, 0.99234968, 0.99260402, 0.99285406, 0.99309981, 0.99334133, 0.99357855, 0.99381155, 0.99404019, 0.9942646, 0.99448478, 0.99470061, 0.99491215, 0.99511945, 0.99532241, 0.99552113, 0.99571556, 0.99590564, 0.99609149, 0.99627298, 0.99645019, 0.99662316, 0.99679178, 0.99695605, 0.99711609, 0.99727178, 0.99742317, 0.99757028, 0.99771303, 0.99785149, 0.99798566, 0.99811548, 0.99824101, 0.99836218, 0.99847907, 0.99859166, 0.9986999, 0.99880379, 0.99890339, 0.9989987, 0.99908966, 0.99917626, 0.99925858, 0.99933654, 0.99941015, 0.99947947, 0.99954444, 0.99960512, 0.99966145, 0.99971342, 0.9997611, 0.99980444, 0.99984342, 0.99987811, 0.99990845, 0.99993443, 0.99995613, 0.99997348, 0.99998647, 0.99999511, 0.99999946, 0.99999946, 0.99999511, 0.99998647, 0.99997348, 0.99995613, 0.99993443, 0.99990845, 0.99987811, 0.99984342, 0.99980444, 0.9997611, 0.99971342, 0.99966145, 0.99960512, 0.99954444, 0.99947947, 0.99941015, 0.99933654, 0.99925858, 0.99917626, 0.99908966, 0.9989987, 0.99890339, 0.99880379, 0.9986999, 0.99859166, 0.99847907, 0.99836218, 0.99824101, 0.99811548, 0.99798566, 0.99785149, 0.99771303, 0.99757028, 0.99742317, 0.99727178, 0.99711609, 0.99695605, 0.99679178, 0.99662316, 0.99645019, 0.99627298, 0.99609149, 0.99590564, 0.99571556, 0.99552113, 0.99532241, 0.99511945, 0.99491215, 0.99470061, 0.99448478, 0.9942646, 0.99404019, 0.99381155, 0.99357855, 0.99334133, 0.99309981, 0.99285406, 0.99260402, 0.99234968, 0.99209112, 0.99182832, 0.99156123, 0.99128985, 0.9910143, 0.99073446, 0.99045038, 0.99016201, 0.98986948, 0.98957264, 0.98927158, 0.98896635, 0.98865682, 0.98834306, 0.98802513, 0.98770297, 0.98737657, 0.98704594, 0.98671108, 0.98637205, 0.98602885, 0.98568135, 0.98532975, 0.98497391, 0.9846139, 0.98424965, 0.98388124, 0.98350865, 0.98313189, 0.98275095, 0.98236585, 0.98197657, 0.98158312, 0.9811855, 0.98078376, 0.98037785, 0.97996777, 0.97955358, 0.97913522, 0.97871274, 0.97828615, 0.97785538, 0.97742051, 0.97698152, 0.97653842, 0.97609115, 0.97563982, 0.97518438, 0.97472489, 0.97426122, 0.97379351, 0.97332168, 0.97284579, 0.9723658, 0.97188175, 0.97139364, 0.97090149, 0.97040522, 0.96990496, 0.96940058, 0.96889222, 0.9683798, 0.96786332, 0.96734279, 0.96681827, 0.96628976, 0.96575719, 0.96522057, 0.96468002, 0.96413541, 0.96358687, 0.96303427, 0.96247774, 0.96191722, 0.96135271, 0.9607842, 0.96021175, 0.95963538, 0.95905501, 0.9584707, 0.95788246, 0.95729029, 0.95669413, 0.95609409, 0.95549017, 0.95488226, 0.95427048, 0.95365477, 0.95303524, 0.95241171, 0.95178437, 0.9511531, 0.95051801, 0.94987905, 0.94923615, 0.9485895, 0.94793892, 0.94728452, 0.94662631, 0.94596422, 0.94529837, 0.94462866, 0.94395512, 0.94327778, 0.94259667, 0.94191176, 0.94122303, 0.9405306, 0.9398343, 0.9391343, 0.93843049, 0.93772298, 0.93701166, 0.93629664, 0.93557787, 0.9348554, 0.93412918, 0.93339926, 0.93266565, 0.93192834, 0.93118733, 0.93044257, 0.92969424, 0.92894214, 0.92818642, 0.92742705, 0.92666405, 0.92589736, 0.92512709, 0.92435312, 0.92357558, 0.9227944, 0.92200965, 0.92122126, 0.92042929, 0.91963375, 0.91883463, 0.91803193, 0.91722566, 0.91641581, 0.91560251, 0.91478556, 0.91396517, 0.91314119, 0.91231376, 0.91148275, 0.91064829, 0.9098103, 0.90896887, 0.90812391, 0.90727556, 0.90642369, 0.90556836, 0.90470964, 0.90384746, 0.90298182, 0.90211278, 0.90124035, 0.90036446, 0.89948523, 0.8986026, 0.89771658, 0.89682722, 0.89593446, 0.89503837, 0.89413893, 0.8932361, 0.89232999, 0.8914206, 0.89050788, 0.88959181, 0.88867247, 0.88774985, 0.88682395, 0.88589478, 0.88496238, 0.88402671, 0.88308781, 0.88214564, 0.88120025, 0.88025171, 0.87929988, 0.87834489, 0.87738675, 0.87642539, 0.87546086, 0.87449318, 0.87352234, 0.87254834, 0.87157124, 0.87059098, 0.86960769, 0.86862123, 0.86763167, 0.86663902, 0.86564332, 0.86464453, 0.86364269, 0.86263776, 0.86162984, 0.86061889, 0.8596049, 0.85858792, 0.85756791, 0.85654491, 0.855519, 0.85449004, 0.85345811, 0.85242325, 0.85138547, 0.85034472, 0.84930104, 0.8482545, 0.84720504, 0.84615266, 0.84509736, 0.84403926, 0.84297824, 0.84191442, 0.84084773, 0.83977818, 0.83870584, 0.83763069, 0.83655268, 0.83547193, 0.83438838, 0.83330208, 0.83221298, 0.83112115, 0.83002657, 0.82892925, 0.82782918, 0.82672644, 0.82562101, 0.82451284, 0.82340205, 0.82228857, 0.82117242, 0.82005358, 0.81893218, 0.81780809, 0.81668139, 0.81555212, 0.81442022, 0.81328577, 0.81214869, 0.81100911, 0.80986691, 0.8087222, 0.80757499, 0.80642521, 0.80527294, 0.80411816, 0.80296093, 0.8018012, 0.80063897, 0.7994743, 0.79830724, 0.79713768, 0.79596573, 0.79479134, 0.79361457, 0.79243541, 0.79125386, 0.79007, 0.78888375, 0.78769511, 0.78650415, 0.78531092, 0.78411531, 0.78291744, 0.7817173, 0.78051484, 0.77931017, 0.77810317, 0.77689397, 0.77568257, 0.7744689, 0.77325302, 0.77203494, 0.77081472, 0.76959229, 0.76836771, 0.76714098, 0.76591206, 0.7646811, 0.76344794, 0.76221269, 0.76097542, 0.759736, 0.7584945, 0.75725096, 0.75600541, 0.75475776, 0.75350815, 0.75225651, 0.75100285, 0.74974722, 0.74848962, 0.74722999, 0.74596846, 0.74470502, 0.74343961, 0.7421723, 0.74090308, 0.73963195, 0.73835897, 0.73708409, 0.73580736, 0.73452878, 0.73324841, 0.7319662, 0.73068213, 0.72939634, 0.7281087, 0.72681934, 0.72552818, 0.7242353, 0.72294068, 0.72164434, 0.72034627, 0.71904653, 0.71774507, 0.71644193, 0.71513718, 0.71383071, 0.71252269, 0.71121293, 0.70990163, 0.70858872, 0.70727426, 0.70595819, 0.70464051, 0.70332134, 0.70200062, 0.70067835, 0.69935459, 0.69802934, 0.69670254, 0.69537431, 0.69404465, 0.6927135, 0.69138086, 0.69004685, 0.68871146, 0.68737459, 0.68603641, 0.68469679, 0.68335581, 0.68201351, 0.6806699, 0.67932492, 0.67797863, 0.67663103, 0.67528218, 0.67393202, 0.6725806, 0.67122793, 0.66987407, 0.66851896, 0.6671626, 0.6658051, 0.66444635, 0.66308647, 0.66172546, 0.66036326, 0.65899992, 0.65763551, 0.65626991, 0.65490329, 0.65353554, 0.65216672, 0.65079689, 0.64942598, 0.64805406, 0.64668113, 0.64530712, 0.64393222, 0.64255625, 0.64117938, 0.6398015, 0.63842273, 0.637043, 0.63566238, 0.63428086, 0.63289845, 0.63151515, 0.63013101, 0.62874597, 0.62736017, 0.62597346, 0.62458599, 0.62319773, 0.62180871, 0.62041885, 0.61902827, 0.61763692, 0.61624491, 0.61485213, 0.61345863, 0.61206442, 0.61066961, 0.60927409, 0.60787791, 0.60648108, 0.60508364, 0.60368562, 0.60228693, 0.60088772, 0.5994879, 0.59808749, 0.5966866, 0.59528512, 0.59388316, 0.59248066, 0.59107769, 0.58967423, 0.58827031, 0.58686596, 0.58546114, 0.58405584, 0.58265018, 0.58124411, 0.57983768, 0.57843083, 0.57702363, 0.57561612, 0.5742082, 0.57280004, 0.57139152, 0.56998271, 0.56857359, 0.56716424, 0.56575465, 0.56434476, 0.5629347, 0.56152439, 0.56011391, 0.55870318, 0.55729234, 0.55588132, 0.55447012, 0.5530588, 0.55164737, 0.55023581, 0.54882413, 0.54741246, 0.5460006, 0.54458874, 0.54317689, 0.54176491, 0.540353, 0.53894103, 0.53752911, 0.5361172, 0.53470528, 0.53329349, 0.53188169, 0.53047001, 0.5290584, 0.5276469, 0.52623552, 0.52482426, 0.52341318, 0.52200222, 0.52059144, 0.51918083, 0.51777041, 0.51636022, 0.51495028, 0.51354051, 0.51213104, 0.5107218, 0.50931287, 0.50790417, 0.50649583, 0.50508779, 0.50368011, 0.50227273, 0.5008657, 0.49945906, 0.49805278, 0.49664691, 0.49524146, 0.49383643, 0.49243182, 0.49102765, 0.48962396, 0.48822075, 0.48681802, 0.48541579, 0.48401406, 0.48261288, 0.48121223, 0.47981215, 0.4784126, 0.47701365, 0.47561529, 0.47421756, 0.47282043, 0.47142392, 0.4700281, 0.46863291, 0.4672384, 0.46584454, 0.46445143, 0.46305901, 0.4616673, 0.46027634, 0.45888615, 0.4574967, 0.45610803, 0.45472014, 0.45333308, 0.45194682, 0.4505614, 0.44917682, 0.4477931, 0.44641024, 0.44502825, 0.44364718, 0.442267, 0.44088775, 0.43950942, 0.43813205, 0.43675566, 0.43538019, 0.43400574, 0.4326323, 0.43125984, 0.42988843, 0.42851806, 0.42714873, 0.42578045, 0.42441326, 0.42304716, 0.42168215, 0.42031828, 0.4189555, 0.4175939, 0.41623342, 0.41487411, 0.41351599, 0.41215909, 0.41080335, 0.40944883, 0.40809557, 0.40674353, 0.40539274, 0.40404323, 0.402695, 0.40134808, 0.40000245, 0.39865813, 0.39731514, 0.3959735, 0.39463323, 0.39329433, 0.39195681, 0.39062068, 0.38928595, 0.38795266, 0.38662076, 0.38529035, 0.38396138, 0.38263386, 0.38130787, 0.37998334, 0.37866032, 0.37733883, 0.37601888, 0.37470046, 0.37338361, 0.37206832, 0.3707546, 0.36944249, 0.368132, 0.36682311, 0.36551586, 0.36421025, 0.36290628, 0.36160401, 0.3603034, 0.3590045, 0.35770729, 0.35641178, 0.35511804, 0.35382602, 0.35253575, 0.35124725, 0.34996054, 0.34867561, 0.34739247, 0.34611118, 0.34483168, 0.34355405, 0.34227824, 0.34100431, 0.33973226, 0.33846208, 0.33719382, 0.33592746, 0.334663, 0.33340052, 0.33213997, 0.33088136, 0.32962474, 0.32837009, 0.32711744, 0.32586679, 0.32461816, 0.32337156, 0.32212698, 0.3208845, 0.31964403, 0.31840569, 0.3171694, 0.31593522, 0.31470317, 0.31347322, 0.3122454, 0.31101975, 0.30979624, 0.30857489, 0.30735573, 0.30613878, 0.30492401, 0.30371147, 0.30250114, 0.30129305, 0.30008721, 0.29888365, 0.29768234, 0.29648331, 0.2952866, 0.29409218, 0.29290006, 0.29171029, 0.29052287, 0.28933778, 0.28815505, 0.2869747, 0.28579673, 0.28462115, 0.28344798, 0.28227726, 0.28110892, 0.27994305, 0.2787796, 0.27761865, 0.27646014, 0.27530414, 0.27415061, 0.27299958, 0.27185109, 0.2707051, 0.26956168, 0.26842079, 0.26728246, 0.26614669, 0.26501352, 0.26388291, 0.26275492, 0.26162955, 0.26050681, 0.25938669, 0.25826919, 0.25715438, 0.25604221, 0.25493273, 0.25382593, 0.25272185, 0.25162044, 0.25052178, 0.24942581, 0.2483326, 0.24724214, 0.24615443, 0.24506949, 0.24398734, 0.24290797, 0.24183139, 0.24075763, 0.2396867, 0.23861858, 0.2375533, 0.23649088, 0.23543131, 0.23437463, 0.2333208, 0.23226988, 0.23122185, 0.23017673, 0.22913453, 0.22809526, 0.22705893, 0.22602555, 0.22499514, 0.22396767, 0.22294319, 0.2219217, 0.2209032, 0.21988772, 0.21887524, 0.21786579, 0.21685939, 0.21585602, 0.2148557, 0.21385846, 0.21286428, 0.21187317, 0.21088518, 0.20990027, 0.20891848, 0.2079398, 0.20696425, 0.20599185, 0.20502259, 0.20405649, 0.20309354, 0.20213379, 0.20117719, 0.20022382, 0.19927362, 0.19832665, 0.19738288, 0.19644235, 0.19550505, 0.194571, 0.19364022, 0.19271268, 0.19178842, 0.19086745, 0.18994975, 0.18903537, 0.18812428, 0.18721652, 0.18631206, 0.18541096, 0.18451318, 0.18361875, 0.18272769, 0.18183999, 0.18095566, 0.18007472, 0.17919718, 0.17832303, 0.17745228, 0.17658496, 0.17572105, 0.17486058, 0.17400354, 0.17314996, 0.17229983, 0.17145316, 0.17060998, 0.16977027, 0.16893405, 0.16810131, 0.16727209, 0.16644639, 0.16562419, 0.16480553, 0.16399039, 0.16317882, 0.16237077, 0.1615663, 0.16076538, 0.15996805, 0.15917428, 0.15838411, 0.15759754, 0.15681456, 0.1560352, 0.15525945, 0.15448733, 0.15371884, 0.152954, 0.15219279, 0.15143524, 0.15068135, 0.14993113, 0.14918458, 0.14844173, 0.14770254, 0.14696707, 0.1462353, 0.14550723, 0.14478289, 0.14406227, 0.14334537, 0.14263222, 0.1419228, 0.14121713, 0.14051522, 0.13981709, 0.13912271, 0.13843212, 0.13774531, 0.13706228, 0.13638306, 0.13570765, 0.13503602, 0.13436823, 0.13370426, 0.13304411, 0.13238779, 0.13173531, 0.13108669, 0.13044192, 0.12980101, 0.12916395, 0.12853077, 0.12790146, 0.12727605, 0.12665451, 0.12603687, 0.12542313, 0.1248133, 0.12420738, 0.12360538, 0.1230073, 0.12241315, 0.12182293, 0.12123665, 0.12065432, 0.12007594, 0.11950152, 0.11893106, 0.11836456, 0.11780204, 0.11724349, 0.11668893, 0.11613835, 0.11559177, 0.11504919, 0.11451062, 0.11397605, 0.11344549, 0.11291895, 0.11239644, 0.11187796, 0.11136351, 0.11085309, 0.11034673, 0.1098444, 0.10934614, 0.10885192, 0.10836177, 0.1078757, 0.10739368, 0.10691575, 0.10644189, 0.10597213, 0.10550644, 0.10504486, 0.10458737, 0.10413399, 0.1036847, 0.10323954, 0.10279848, 0.10236154, 0.10192873, 0.10150005, 0.10107549, 0.10065508, 0.1002388, 0.099826664, 0.099418677, 0.099014841, 0.098615155, 0.098219633, 0.097828269, 0.097441077, 0.09705805, 0.096679196, 0.096304521, 0.095934026, 0.095567711, 0.09520559, 0.094847649, 0.094493911, 0.094144367, 0.093799025, 0.093457893, 0.093120962, 0.092788242, 0.092459731, 0.092135444, 0.091815367, 0.091499522, 0.091187902, 0.090880506, 0.090577342, 0.090278409, 0.089983724, 0.089693271, 0.089407064, 0.089125097, 0.088847384, 0.088573918, 0.088304706, 0.088039748, 0.087779053, 0.087522611, 0.087270439, 0.087022528, 0.086778887, 0.086539514, 0.086304419, 0.086073592, 0.085847043, 0.085624777, 0.085406788, 0.085193083, 0.084983662, 0.084778532, 0.084577687, 0.084381133, 0.084188871, 0.084000908, 0.083817236, 0.083637863, 0.08346279, 0.083292022, 0.083125554, 0.082963385, 0.082805529, 0.08265198, 0.082502738, 0.082357809, 0.082217187, 0.082080886, 0.081948891, 0.081821218, 0.081697851, 0.081578813, 0.081464089, 0.081353687, 0.081247605, 0.081145845, 0.081048414, 0.080955304, 0.080866516, 0.080782056, 0.080701917, 0.080626108, 0.080554634, 0.080487482, 0.080424659, 0.080366172, 0.080312006, 0.080262177, 0.080216676, 0.080175512, 0.080138676, 0.080106176, 0.080078006, 0.080054171, 0.080034673, 0.080019504, 0.080008671, 0.080002166, 0.079999998};
const float32_t hamming_window_1024[] = {0.08, 0.0800086763075893, 0.0800347049030599, 0.0800780848045333, 0.0801388143755861, 0.080216891325312, 0.0803123127084083, 0.0804250749252868, 0.0805551737222099, 0.0807026041914506, 0.0808673607714782, 0.0810494372471675, 0.0812488267500337, 0.0814655217584913, 0.081699514098138, 0.0819507949420629, 0.0822193548111794, 0.0825051835745831, 0.0828082704499337, 0.0831286040038617, 0.0834661721524002, 0.0838209621614398, 0.0841929606472102, 0.0845821535767837, 0.084988526268606, 0.0854120633930487, 0.0858527489729886, 0.0863105663844099, 0.0867854983570313, 0.0872775269749577, 0.087786633677356, 0.0883127992591549, 0.0888560038717702, 0.0894162270238526, 0.0899934475820612, 0.090587643771861, 0.0911987931783435, 0.0918268727470729, 0.0924718587849557, 0.0931337269611342, 0.0938124523079046, 0.0945080092216587, 0.0952203714638499, 0.0959495121619829, 0.0966954038106273, 0.0974580182724553, 0.0982373267793034, 0.0990332999332572, 0.0998459077077604, 0.100675119448748, 0.101520903875802, 0.102383229083331, 0.103262062541777, 0.104157371098837, 0.105069120980718, 0.105997277793409, 0.106941806523981, 0.107902671541903, 0.108879836600391, 0.109873264837773, 0.110882918778879, 0.111908760336457, 0.112950750812607, 0.114008850900242, 0.115083020684573, 0.11617321964461, 0.117279406654694, 0.118401539986048, 0.119539577308352, 0.120693475691335, 0.121863191606401, 0.123048680928267, 0.124249898936629, 0.125466800317848, 0.126699339166659, 0.127947468987907, 0.129211142698293, 0.130490312628158, 0.131784930523278, 0.133094947546681, 0.134420314280496, 0.135760980727812, 0.137116896314566, 0.138488009891452, 0.139874269735845, 0.141275623553761, 0.142692018481822, 0.144123401089253, 0.145569717379901, 0.147030912794263, 0.148506932211554, 0.149997719951781, 0.151503219777844, 0.153023374897657, 0.154558127966292, 0.156107421088144, 0.157671195819107, 0.159249393168789, 0.160841953602731, 0.162448817044653, 0.164069922878723, 0.165705209951841, 0.167354616575948, 0.169018080530352, 0.170695539064075, 0.172386928898221, 0.174092186228361, 0.175811246726942, 0.177544045545715, 0.179290517318176, 0.181050596162038, 0.182824215681711, 0.184611308970811, 0.186411808614681, 0.188225646692935, 0.190052754782021, 0.191893063957801, 0.19374650479815, 0.195613007385579, 0.197492501309866, 0.199384915670721, 0.201290179080449, 0.203208219666655, 0.205138965074947, 0.207082342471668, 0.209038278546643, 0.211006699515947, 0.212987531124685, 0.214980698649795, 0.216986126902865, 0.219003740232973, 0.221033462529535, 0.223075217225184, 0.22512892729865, 0.227194515277672, 0.229271903241915, 0.231361012825915, 0.233461765222032, 0.235574081183422, 0.237697881027028, 0.239833084636586, 0.241979611465648, 0.244137380540618, 0.246306310463808, 0.248486319416508, 0.250677325162074, 0.25287924504903, 0.255091996014181, 0.257315494585756, 0.259549656886546, 0.261794398637077, 0.264049635158784, 0.266315281377208, 0.268591251825201, 0.270877460646159, 0.273173821597249, 0.275480248052673, 0.277796653006928, 0.280122949078094, 0.282459048511126, 0.284804863181167, 0.28716030459687, 0.289525283903738, 0.291899711887477, 0.294283498977357, 0.296676555249597, 0.299078790430752, 0.301490113901119, 0.303910434698159, 0.306339661519927, 0.308777702728512, 0.3112244663535, 0.313679860095439, 0.316143791329323, 0.318616167108087, 0.321096894166108, 0.323585878922732, 0.326083027485796, 0.328588245655173, 0.331101438926327, 0.333622512493876, 0.336151371255168, 0.338687919813872, 0.341232062483573, 0.34378370329138, 0.346342745981555, 0.348909094019132, 0.35148265059357, 0.354063318622396, 0.356651000754873, 0.35924559937567, 0.361847016608545, 0.364455154320037, 0.367069914123167, 0.369691197381152, 0.372318905211122, 0.374952938487854, 0.377593197847509, 0.380239583691383, 0.382891996189658, 0.385550335285176, 0.388214500697207, 0.390884391925236, 0.393559908252753, 0.396240948751049, 0.39892741228303, 0.401619197507025, 0.404316202880616, 0.407018326664461, 0.40972546692614, 0.412437521543993, 0.415154388210975, 0.417875964438519, 0.420602147560396, 0.423332834736591, 0.426067922957184, 0.428807309046231, 0.431550889665663, 0.434298561319178, 0.437050220356148, 0.439805762975528, 0.442565085229774, 0.445328083028761, 0.448094652143712, 0.450864688211129, 0.453638086736729, 0.456414743099387, 0.459194552555084, 0.461977410240854, 0.464763211178745, 0.467551850279773, 0.470343222347895, 0.473137222083966, 0.475933744089723, 0.47873268287175, 0.481533932845467, 0.484337388339106, 0.487142943597702, 0.489950492787079, 0.492759929997843, 0.495571149249382, 0.498384044493855, 0.501198509620199, 0.504014438458133, 0.506831724782157, 0.509650262315564, 0.512469944734446, 0.515290665671708, 0.518112318721079, 0.520934797441124, 0.523757995359264, 0.526581805975787, 0.529406122767869, 0.532230839193592, 0.535055848695962, 0.53788104470693, 0.540706320651411, 0.543531569951304, 0.546356686029513, 0.549181562313969, 0.552006092241648, 0.554830169262591, 0.557653686843925, 0.56047653847388, 0.563298617665808, 0.5661198179622, 0.568940032938702, 0.571759156208128, 0.574577081424475, 0.577393702286936, 0.580208912543906, 0.583022605996992, 0.585834676505023, 0.588645017988046, 0.591453524431336, 0.594260089889389, 0.597064608489922, 0.599866974437864, 0.602667082019351, 0.605464825605711, 0.608260099657448, 0.611052798728226, 0.613842817468843, 0.61663005063121, 0.619414393072317, 0.6221957397582, 0.624973985767907, 0.62774902629745, 0.630520756663764, 0.633289072308652, 0.63605386880273, 0.63881504184937, 0.641572487288629, 0.644326101101183, 0.647075779412247, 0.649821418495495, 0.652562914776974, 0.655300164839012, 0.658033065424113, 0.660761513438861, 0.663485405957802, 0.666204640227331, 0.668919113669565, 0.671628723886215, 0.674333368662447, 0.677032945970741, 0.679727353974734, 0.682416491033067, 0.685100255703218, 0.687778546745326, 0.690451263126014, 0.693118304022197, 0.695779568824889, 0.698434957142992, 0.70108436880709, 0.703727703873225, 0.706364862626666, 0.708995745585672, 0.711620253505242, 0.714238287380865, 0.716849748452248, 0.719454538207046, 0.722052558384575, 0.724643710979522, 0.727227898245639, 0.729805022699433, 0.732374987123839, 0.734937694571895, 0.73749304837039, 0.740040952123518, 0.742581309716512, 0.745114025319266, 0.747639003389958, 0.750156148678645, 0.752665366230864, 0.755166561391209, 0.757659639806904, 0.760144507431361, 0.762621070527729, 0.765089235672428, 0.767548909758676, 0.77, 0.772442413933734, 0.774876059424512, 0.777300844667738, 0.779716678193053, 0.782123468867784, 0.784521125900383, 0.786909558843849, 0.789288677599145, 0.791658392418592, 0.794018613909255, 0.796369253036321, 0.798710221126448, 0.801041429871119, 0.803362791329967, 0.805674217934098, 0.807975622489388, 0.810266918179778, 0.812548018570544, 0.814818837611563, 0.817079289640554, 0.819329289386312, 0.821568751971925, 0.823797592917974, 0.826015728145723, 0.828223073980285, 0.830419547153786, 0.8326050648085, 0.834779544499977, 0.836942904200154, 0.839095062300447, 0.841235937614831, 0.843365449382904, 0.84548351727293, 0.847590061384872, 0.849685002253406, 0.851768260850916, 0.85383975859048, 0.85589941732883, 0.857947159369301, 0.859982907464765, 0.862006584820539, 0.864018115097289, 0.866017422413904, 0.868004431350361, 0.869979066950571, 0.871941254725202, 0.873890920654497, 0.875827991191057, 0.877752393262623, 0.879664054274828, 0.881562902113939, 0.883448865149572, 0.885321872237399, 0.887181852721832, 0.889028736438684, 0.890862453717819, 0.892682935385781, 0.894490112768399, 0.896283917693384, 0.898064282492895, 0.899831140006095, 0.901584423581682, 0.903324067080407, 0.905050004877563, 0.906762171865469, 0.908460503455917, 0.910144935582615, 0.911815404703602, 0.913471847803642, 0.915114202396607, 0.916742406527827, 0.918356398776435, 0.919956118257677, 0.921541504625213, 0.923112498073392, 0.924669039339507, 0.926211069706034, 0.927738531002843, 0.929251365609394, 0.930749516456913, 0.93223292703054, 0.933701541371465, 0.935155304079036, 0.936594160312852, 0.938018055794828, 0.939426936811248, 0.940820750214785, 0.942199443426508, 0.943562964437869, 0.944911261812659, 0.946244284688955, 0.947561982781032, 0.948864306381265, 0.950151206362, 0.951422634177411, 0.952678541865329, 0.953918882049054, 0.955143607939136, 0.956352673335148, 0.957546032627423, 0.958723640798778, 0.959885453426209, 0.961031426682569, 0.962161517338223, 0.963275682762673, 0.964373880926172, 0.965456070401308, 0.966522210364563, 0.967572260597858, 0.968606181490068, 0.969623934038516, 0.970625479850445, 0.971610781144465, 0.972579800751981, 0.973532502118591, 0.97446884930547, 0.975388806990721, 0.976292340470709, 0.977179415661373, 0.978049999099505, 0.978904057944023, 0.979741559977197, 0.980562473605875, 0.981366767862669, 0.982154412407126, 0.982925377526869, 0.983679634138724, 0.984417153789809, 0.985137908658616, 0.985841871556052, 0.986529015926472, 0.987199315848676, 0.987852746036888, 0.988489281841713, 0.98910889925106, 0.989711574891055, 0.990297286026919, 0.990866010563826, 0.991417727047736, 0.991952414666207, 0.992470053249176, 0.992970623269724, 0.99345410584481, 0.993920482735983, 0.994369736350072, 0.994801849739849, 0.995216806604667, 0.995614591291077, 0.995995188793417, 0.996358584754378, 0.996704765465546, 0.99703371786792, 0.997345429552403, 0.997639888760272, 0.997917084383619, 0.998177005965773, 0.998419643701692, 0.998644988438333, 0.998853031675001, 0.999043765563665, 0.999217182909255, 0.999373277169935, 0.99951204245735, 0.999633473536847, 0.99973756582767, 0.99982431540314, 0.999893718990795, 0.999945773972518, 0.999980478384635, 0.999997830917989, 0.999997830917989, 0.999980478384635, 0.999945773972518, 0.999893718990795, 0.99982431540314, 0.99973756582767, 0.999633473536847, 0.99951204245735, 0.999373277169935, 0.999217182909255, 0.999043765563665, 0.998853031675001, 0.998644988438333, 0.998419643701692, 0.998177005965773, 0.997917084383619, 0.997639888760272, 0.997345429552403, 0.99703371786792, 0.996704765465546, 0.996358584754378, 0.995995188793417, 0.995614591291077, 0.995216806604667, 0.994801849739849, 0.994369736350072, 0.993920482735983, 0.99345410584481, 0.992970623269724, 0.992470053249176, 0.991952414666207, 0.991417727047736, 0.990866010563826, 0.990297286026919, 0.989711574891055, 0.98910889925106, 0.988489281841713, 0.987852746036888, 0.987199315848676, 0.986529015926472, 0.985841871556052, 0.985137908658616, 0.984417153789809, 0.983679634138724, 0.982925377526869, 0.982154412407126, 0.981366767862669, 0.980562473605875, 0.979741559977197, 0.978904057944023, 0.978049999099505, 0.977179415661373, 0.976292340470709, 0.975388806990721, 0.97446884930547, 0.973532502118591, 0.972579800751981, 0.971610781144465, 0.970625479850445, 0.969623934038516, 0.968606181490068, 0.967572260597858, 0.966522210364563, 0.965456070401308, 0.964373880926172, 0.963275682762673, 0.962161517338223, 0.961031426682569, 0.959885453426209, 0.958723640798778, 0.957546032627423, 0.956352673335148, 0.955143607939136, 0.953918882049054, 0.952678541865329, 0.951422634177411, 0.950151206362, 0.948864306381265, 0.947561982781032, 0.946244284688955, 0.944911261812659, 0.943562964437869, 0.942199443426508, 0.940820750214785, 0.939426936811248, 0.938018055794828, 0.936594160312852, 0.935155304079036, 0.933701541371465, 0.93223292703054, 0.930749516456913, 0.929251365609394, 0.927738531002843, 0.926211069706034, 0.924669039339507, 0.923112498073392, 0.921541504625213, 0.919956118257677, 0.918356398776435, 0.916742406527827, 0.915114202396607, 0.913471847803642, 0.911815404703602, 0.910144935582615, 0.908460503455917, 0.906762171865469, 0.905050004877563, 0.903324067080407, 0.901584423581682, 0.899831140006095, 0.898064282492895, 0.896283917693384, 0.894490112768399, 0.892682935385781, 0.890862453717819, 0.889028736438684, 0.887181852721832, 0.885321872237399, 0.883448865149572, 0.881562902113939, 0.879664054274828, 0.877752393262623, 0.875827991191057, 0.873890920654497, 0.871941254725202, 0.869979066950571, 0.868004431350361, 0.866017422413904, 0.864018115097289, 0.862006584820539, 0.859982907464765, 0.857947159369301, 0.85589941732883, 0.85383975859048, 0.851768260850916, 0.849685002253406, 0.847590061384872, 0.84548351727293, 0.843365449382904, 0.841235937614831, 0.839095062300447, 0.836942904200154, 0.834779544499977, 0.8326050648085, 0.830419547153786, 0.828223073980285, 0.826015728145723, 0.823797592917974, 0.821568751971925, 0.819329289386312, 0.817079289640554, 0.814818837611563, 0.812548018570544, 0.810266918179778, 0.807975622489388, 0.805674217934098, 0.803362791329967, 0.801041429871119, 0.798710221126448, 0.796369253036321, 0.794018613909255, 0.791658392418592, 0.789288677599145, 0.786909558843849, 0.784521125900383, 0.782123468867784, 0.779716678193053, 0.777300844667738, 0.774876059424512, 0.772442413933734, 0.77, 0.767548909758676, 0.765089235672428, 0.762621070527729, 0.760144507431361, 0.757659639806904, 0.755166561391209, 0.752665366230864, 0.750156148678645, 0.747639003389958, 0.745114025319266, 0.742581309716512, 0.740040952123518, 0.73749304837039, 0.734937694571895, 0.732374987123839, 0.729805022699433, 0.727227898245639, 0.724643710979522, 0.722052558384575, 0.719454538207046, 0.716849748452248, 0.714238287380865, 0.711620253505242, 0.708995745585672, 0.706364862626666, 0.703727703873225, 0.70108436880709, 0.698434957142992, 0.695779568824889, 0.693118304022197, 0.690451263126014, 0.687778546745326, 0.685100255703218, 0.682416491033067, 0.679727353974734, 0.677032945970741, 0.674333368662447, 0.671628723886215, 0.668919113669565, 0.666204640227331, 0.663485405957802, 0.660761513438861, 0.658033065424113, 0.655300164839012, 0.652562914776974, 0.649821418495495, 0.647075779412247, 0.644326101101183, 0.641572487288629, 0.63881504184937, 0.63605386880273, 0.633289072308652, 0.630520756663764, 0.62774902629745, 0.624973985767907, 0.6221957397582, 0.619414393072317, 0.61663005063121, 0.613842817468843, 0.611052798728226, 0.608260099657448, 0.605464825605711, 0.602667082019351, 0.599866974437864, 0.597064608489922, 0.594260089889389, 0.591453524431336, 0.588645017988046, 0.585834676505023, 0.583022605996992, 0.580208912543906, 0.577393702286936, 0.574577081424475, 0.571759156208128, 0.568940032938702, 0.5661198179622, 0.563298617665808, 0.56047653847388, 0.557653686843925, 0.554830169262591, 0.552006092241648, 0.549181562313969, 0.546356686029513, 0.543531569951304, 0.540706320651411, 0.53788104470693, 0.535055848695962, 0.532230839193592, 0.529406122767869, 0.526581805975787, 0.523757995359264, 0.520934797441124, 0.518112318721079, 0.515290665671708, 0.512469944734446, 0.509650262315564, 0.506831724782157, 0.504014438458133, 0.501198509620199, 0.498384044493855, 0.495571149249382, 0.492759929997843, 0.489950492787079, 0.487142943597702, 0.484337388339106, 0.481533932845467, 0.47873268287175, 0.475933744089723, 0.473137222083966, 0.470343222347895, 0.467551850279773, 0.464763211178745, 0.461977410240854, 0.459194552555084, 0.456414743099387, 0.453638086736729, 0.450864688211129, 0.448094652143712, 0.445328083028761, 0.442565085229774, 0.439805762975528, 0.437050220356148, 0.434298561319178, 0.431550889665663, 0.428807309046231, 0.426067922957184, 0.423332834736591, 0.420602147560396, 0.417875964438519, 0.415154388210975, 0.412437521543993, 0.40972546692614, 0.407018326664461, 0.404316202880616, 0.401619197507025, 0.39892741228303, 0.396240948751049, 0.393559908252753, 0.390884391925236, 0.388214500697207, 0.385550335285176, 0.382891996189658, 0.380239583691383, 0.377593197847509, 0.374952938487854, 0.372318905211122, 0.369691197381152, 0.367069914123167, 0.364455154320037, 0.361847016608545, 0.35924559937567, 0.356651000754873, 0.354063318622396, 0.35148265059357, 0.348909094019132, 0.346342745981555, 0.34378370329138, 0.341232062483573, 0.338687919813872, 0.336151371255168, 0.333622512493876, 0.331101438926327, 0.328588245655173, 0.326083027485796, 0.323585878922732, 0.321096894166108, 0.318616167108087, 0.316143791329323, 0.313679860095439, 0.3112244663535, 0.308777702728512, 0.306339661519927, 0.303910434698159, 0.301490113901119, 0.299078790430752, 0.296676555249597, 0.294283498977357, 0.291899711887477, 0.289525283903738, 0.28716030459687, 0.284804863181167, 0.282459048511126, 0.280122949078094, 0.277796653006928, 0.275480248052673, 0.273173821597249, 0.270877460646159, 0.268591251825201, 0.266315281377208, 0.264049635158784, 0.261794398637077, 0.259549656886546, 0.257315494585756, 0.255091996014181, 0.25287924504903, 0.250677325162074, 0.248486319416508, 0.246306310463808, 0.244137380540618, 0.241979611465648, 0.239833084636586, 0.237697881027028, 0.235574081183422, 0.233461765222032, 0.231361012825915, 0.229271903241915, 0.227194515277672, 0.22512892729865, 0.223075217225184, 0.221033462529535, 0.219003740232973, 0.216986126902865, 0.214980698649795, 0.212987531124685, 0.211006699515947, 0.209038278546643, 0.207082342471668, 0.205138965074947, 0.203208219666655, 0.201290179080449, 0.199384915670721, 0.197492501309866, 0.195613007385579, 0.19374650479815, 0.191893063957801, 0.190052754782021, 0.188225646692935, 0.186411808614681, 0.184611308970811, 0.182824215681711, 0.181050596162038, 0.179290517318176, 0.177544045545715, 0.175811246726942, 0.174092186228361, 0.172386928898221, 0.170695539064075, 0.169018080530352, 0.167354616575948, 0.165705209951841, 0.164069922878723, 0.162448817044653, 0.160841953602731, 0.159249393168789, 0.157671195819107, 0.156107421088144, 0.154558127966292, 0.153023374897657, 0.151503219777844, 0.149997719951781, 0.148506932211554, 0.147030912794263, 0.145569717379901, 0.144123401089253, 0.142692018481822, 0.141275623553761, 0.139874269735845, 0.138488009891452, 0.137116896314566, 0.135760980727812, 0.134420314280496, 0.133094947546681, 0.131784930523278, 0.130490312628158, 0.129211142698293, 0.127947468987907, 0.126699339166659, 0.125466800317848, 0.124249898936629, 0.123048680928267, 0.121863191606401, 0.120693475691335, 0.119539577308352, 0.118401539986048, 0.117279406654694, 0.11617321964461, 0.115083020684573, 0.114008850900242, 0.112950750812607, 0.111908760336457, 0.110882918778879, 0.109873264837773, 0.108879836600391, 0.107902671541903, 0.106941806523981, 0.105997277793409, 0.105069120980718, 0.104157371098837, 0.103262062541777, 0.102383229083331, 0.101520903875802, 0.100675119448748, 0.0998459077077604, 0.0990332999332572, 0.0982373267793034, 0.0974580182724553, 0.0966954038106273, 0.0959495121619829, 0.0952203714638499, 0.0945080092216587, 0.0938124523079046, 0.0931337269611342, 0.0924718587849557, 0.0918268727470729, 0.0911987931783435, 0.090587643771861, 0.0899934475820612, 0.0894162270238526, 0.0888560038717702, 0.0883127992591549, 0.087786633677356, 0.0872775269749577, 0.0867854983570313, 0.0863105663844099, 0.0858527489729886, 0.0854120633930487, 0.084988526268606, 0.0845821535767837, 0.0841929606472102, 0.0838209621614398, 0.0834661721524002, 0.0831286040038617, 0.0828082704499337, 0.0825051835745831, 0.0822193548111794, 0.0819507949420629, 0.081699514098138, 0.0814655217584913, 0.0812488267500337, 0.0810494372471675, 0.0808673607714782, 0.0807026041914506, 0.0805551737222099, 0.0804250749252868, 0.0803123127084083, 0.080216891325312, 0.0801388143755861, 0.0800780848045333, 0.0800347049030599, 0.0800086763075893, 0.08 };

float32_t mel=0,ftemp=0;
uint16_t f[NFILT+2]={0};



/* tFiltInit costruisce i filtri triangolari e li infila in due vettori
 * e inoltre costruisce gli handle per ogni filtro
 */
void tFiltInit()
{
	float32_t Mstart = 1125*logf(1+((float32_t)FSTART/700));
	float32_t Mstop = 1125*logf(1+((float32_t)FSTOP/700));



	for (int var = 0; var < NFILT+2; ++var)
	{
		mel=Mstart+(Mstop-Mstart)*var/(NFILT+1);
		ftemp=700*(expf(mel/1125)-1);
		f[var]=floorf((float32_t)(NFFT+1)*(float32_t)ftemp / FS);
	}

	for (int m = 1; m< NFILT+1; m=m+2) 		// calcola due filtri per ogni ciclo
	{										// da salvare in vettori diversi per
		hfilt[m-1].fstart=f[m-1];			// evitare sovrapposizioni
		hfilt[m-1].len=f[m+1]-f[m-1];
		hfilt[m-1].fdata=&dispari[f[m-1]];

		for (int k = f[m-1]; k < f[m]; ++k)	// ramo in salita del primo
		{
			dispari[k]=(float32_t)(k-f[m-1]) / (float32_t)(f[m] - f[m - 1]);
		}
		for (int k = f[m]; k < f[m+1]; ++k)	// ramo in discesa del primo
		{
			dispari[k]=(float32_t)(f[m+1]-k) / (float32_t)(f[m+1] - f[m]);
		}



		hfilt[m].fstart=f[m];
		hfilt[m].len=f[m+2]-f[m];
		hfilt[m].fdata=&pari[f[m]];
		for (int k = f[m]; k < f[m+1]; ++k)		// ramo in salita del secondo
		{
			pari[k]=(float32_t)(k-f[m]) / (float32_t)(f[m+1] - f[m]);
		}
		for (int k = f[m+1]; k < f[m+2]; ++k)	// ramo in discesa del secondo
		{
			pari[k]=(float32_t)(f[m+2]-k) / (float32_t)(f[m+2] - f[m+1]);
		}


	}

	parametriDCT();
}


float32_t buffero[NFFT+2], buffera[NFFT];
/* Calcola lo spettro di potenza di un frame
 * pIn: 	puntatore al frame da calcolare
 * len: 	lunghezza del frame (deve essere una potenza di due)
 * pOut: 	puntatore al buffer di uscita, lungo 1+len/2
 */
void powerSpectrum(float32_t * pIn, uint16_t len, float32_t * pOut)
{
	arm_fir_init_f32(&prem,2,tappi,prestato,len);
	arm_mult_f32(pIn,hamming_window_1024,buffero,len);
	arm_fir_f32(&prem,buffero,buffera,len);			// pre enfasi

	arm_rfft_fast_instance_f32 hfft;

	arm_rfft_fast_init_f32(&hfft,len);

	arm_rfft_fast_f32(&hfft,buffera,buffero,0);

	buffero[len]=buffero[1];
	buffero[1]=0.0f;
	buffero[len+1]=0.0f;

	arm_cmplx_mag_squared_f32(buffero,pOut,1+len/2);	// calcola il modulo^2 della FFT
	arm_scale_f32(pOut,1.0f/(float32_t)len ,pOut,1+len/2);	// divide per len

}

/* applica i filtri calcolati al frame e calcola gli MFCC (da finire)
 * pIn: 	puntatore al frame
 * pOut: 	puntatore al buffer di uscita, lungo nFilt
 * inLen: 	lunghezza del frame
 * nFilt:	numero di filtri
 * filtri:	puntatore all'array di handle dei filtri
 */
void filtraggi(
		float32_t * pIn,
		float32_t * pOut,
		uint16_t inLen,
		uint16_t nFilt,
		ftri_handle * filtri)
{
	float32_t temp[257],filtrato[257],temp2[NFILT];

	for (int n = 0; n < nFilt; ++n) {

		arm_fill_f32(0.0f,temp,inLen);	// riempie l'array temp di 0
		arm_copy_f32((filtri+n)->fdata,&temp[(filtri+n)->fstart],(filtri+n)->len);
		// copia il filtro ennesimo in temp al punto giusto

		arm_mult_f32(pIn,temp,filtrato,inLen); 	// applica il filtro temp a pIn
		*(temp2+n)=0;
		for (int i = 0; i < inLen; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n)+=*(filtrato+i);

		}
		*(temp2+n)=logf(*(temp2+n));
	}

	arm_matrix_instance_f32 DCTPMat={NFILT, NFILT, DCTParam};
	arm_matrix_instance_f32 DCTin={NFILT,1,temp2};
	arm_matrix_instance_f32 DCTout={NFILT,1,pOut};

	arm_mat_mult_f32(&DCTPMat, &DCTin,&DCTout);
}

/* applica i filtri calcolati al frame e calcola gli MFCC
 * pIn: 	puntatore al frame
 * pOut: 	puntatore al buffer di uscita, lungo nFilt
 * inLen: 	lunghezza del frame
 * nFilt:	numero di filtri
 * filtri:	puntatore all'array di handle dei filtri
 */
void estrazione(
		float32_t * pIn,
		float32_t * pOut,
		uint16_t inLen,
		uint16_t nFilt,
		ftri_handle * filtri)
{
	float32_t tempdisp[1+NFFT/2],temppari[1+NFFT/2],filtrato[1+NFFT/2],temp2[NFILT];

	arm_mult_f32(pIn,dispari,tempdisp,inLen);
	arm_mult_f32(pIn,pari,temppari,inLen);

	for (int n = 0; n < nFilt; n+=2) {

		arm_fill_f32(0.0f,filtrato,inLen);	// riempie l'array temp di 0
		arm_copy_f32(&(tempdisp[(filtri+n)->fstart]),&filtrato[(filtri+n)->fstart],(filtri+n)->len);

		*(temp2+n)=0;
		for (int i = 0; i < inLen; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n)+=*(filtrato+i);

		}
		*(temp2+n)=log10f(*(temp2+n));





		arm_fill_f32(0.0f,filtrato,inLen);	// riempie l'array temp di 0
		arm_copy_f32(&(temppari[(filtri+n+1)->fstart]),&filtrato[(filtri+n+1)->fstart],(filtri+n+1)->len);
		// copia il filtro ennesimo in temp al punto giusto
		*(temp2+n+1)=0;
		for (int i = 0; i < inLen; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n+1)+=*(filtrato+i);

		}
		*(temp2+n+1)=log10f(*(temp2+n+1));
	}

	arm_matrix_instance_f32 DCTPMat={NFILT, NFILT, DCTParam};
	arm_matrix_instance_f32 DCTin={NFILT,1,temp2};
	arm_matrix_instance_f32 DCTout={NFILT,1,pOut};

	arm_mat_mult_f32(&DCTPMat, &DCTin,&DCTout);
}


void prenfasi()
{

}

void estrazione2(
		float32_t * pIn,
		float32_t * pOut,
		uint16_t inLen,
		uint16_t nFilt,
		uint16_t nMFFC,
		ftri_handle * filtri)
{
	float32_t tempdisp[1+NFFT/2],temppari[1+NFFT/2],/*filtrato[1+NFFT/2],*/temp2[NFILT],tempout[NFILT];

	arm_mult_f32(pIn,dispari,tempdisp,inLen);
	arm_mult_f32(pIn,pari,temppari,inLen);

	for (int n = 0; n < nFilt; n+=2) {

		//arm_fill_f32(0.0f,filtrato,inLen);	// riempie l'array temp di 0
		//arm_copy_f32(&(tempdisp[(filtri+n)->fstart]),&filtrato[(filtri+n)->fstart],(filtri+n)->len);

		*(temp2+n)=0;
		for (int i = 0; i < (filtri+n)->len; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n)+=*(tempdisp+i+(filtri+n)->fstart);

		}
		*(temp2+n)=logf(*(temp2+n));





		//arm_fill_f32(0.0f,filtrato,inLen);	// riempie l'array temp di 0
		//arm_copy_f32(&(temppari[(filtri+n+1)->fstart]),&filtrato[(filtri+n+1)->fstart],(filtri+n+1)->len);
		// copia il filtro ennesimo in temp al punto giusto
		*(temp2+n+1)=0;
		for (int i = 0; i < (filtri+n+1)->len; ++i) 	 	// somma tutti i campioni e
		{									 	// calcola il log
			*(temp2+n+1)+=*(temppari+i+(filtri+n+1)->fstart);

		}
		*(temp2+n+1)=logf(*(temp2+n+1));
	}

	arm_matrix_instance_f32 DCTPMat={NFILT, NFILT, DCTParam};
	arm_matrix_instance_f32 DCTin={NFILT,1,temp2};
	arm_matrix_instance_f32 DCTout={NFILT,1,tempout};

	arm_mat_mult_f32(&DCTPMat, &DCTin,&DCTout);
	arm_copy_f32(tempout,pOut,nMFFC);
}



void parametriDCT()
{

	for (int k = 0; k < NFILT; ++k)
	{
		for (int n = 0; n < NFILT; ++n)
		{
			DCTParam[(k*26)+n]=arm_cos_f32(((float32_t)PI/(float32_t)NFILT)*(n+0.5f)*k);
		}
	}
}
